<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helvitic AI Chatbot</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.glass-effect {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}
.gradient-bg {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: #cbd5e1 #f1f5f9;
}
.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
}
.scrollbar-thin::-webkit-scrollbar-track {
  background: #f1f5f9;
}
.scrollbar-thin::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}
</style>
</head>
<body>

<!-- FenÃªtre du chatbot -->
<div id="chatbot-window" class="w-full h-screen glass-effect flex flex-col">

  <!-- Header -->
  <div class="gradient-bg text-white flex justify-between items-center p-4">
    <span class="font-bold">Helvitic AI</span>
    <select id="lang-select" class="text-black rounded px-2 py-1">
      <option value="fr">ðŸ‡«ðŸ‡· FR</option>
      <option value="en">ðŸ‡¬ðŸ‡§ EN</option>
      <option value="de">ðŸ‡©ðŸ‡ª DE</option>
    </select>
    <button onclick="parent.closeChatbot()" class="ml-2 text-lg font-bold">âœ•</button>
  </div>

  <!-- Messages -->
  <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 space-y-3 scrollbar-thin"></div>

  <!-- FAQ rapide -->
  <div id="faq-container" class="p-3 border-t bg-gray-50">
    <div id="faq-title" class="font-semibold mb-2 text-gray-700"></div>
    <div id="faq-quick" class="flex flex-wrap gap-2"></div>
  </div>
</div>

<!-- Base de connaissances -->
<script>
const faq = {
  fr: {
    "ia finance definition qu'est-ce": "L'IA appliquÃ©e Ã  la performance financiÃ¨re ...",
    "avantages benefices ia epm finance": "Les avantages incluent : automatisation des processus ..."
  },
  en: {
    "what ai finance definition artificial intelligence": "AI in financial performance uses advanced algorithms ..."
  },
  de: {
    "was ist ki finanzen definition": "KI in der Finanzperformance nutzt fortgeschrittene Algorithmen ..."
  }
};

const quickQuestions = {
  fr: [
    "Qu'est-ce que l'IA en finance ?",
    "Quels sont les avantages de l'IA pour l'EPM ?",
    "Comment intÃ©grer l'IA dans mon systÃ¨me ?",
    "Quel est le ROI de l'IA en finance ?",
    "Quelles technologies IA utilisez-vous ?",
    "Combien coÃ»te une implÃ©mentation IA ?",
    "L'IA peut-elle amÃ©liorer mes prÃ©visions ?",
    "Comment assurer la sÃ©curitÃ© des donnÃ©es ?"
  ],
  en: [
    "What is AI in finance?",
    "What are the benefits of AI for EPM?",
    "How to integrate AI in my system?",
    "What is the ROI of AI in finance?",
    "What AI technologies do you use?",
    "How much does AI implementation cost?",
    "Can AI improve my forecasts?",
    "How to ensure data security?"
  ],
  de: [
    "Was ist KI im Finanzwesen?",
    "Was sind die Vorteile von KI fÃ¼r EPM?",
    "Wie integriere ich KI in mein System?",
    "Was ist der ROI von KI im Finanzwesen?",
    "Welche KI-Technologien verwenden Sie?",
    "Wie viel kostet eine KI-Implementierung?",
    "Kann KI meine Prognosen verbessern?",
    "Wie stelle ich Datensicherheit sicher?"
  ]
};
</script>

<!-- Script principal -->
<script>
const messagesContainer = document.getElementById("chatbot-messages");
const faqQuick = document.getElementById("faq-quick");
const faqTitle = document.getElementById("faq-title");
const langSelect = document.getElementById("lang-select");

let currentLang = "fr";
let expanded = false;

// Fonction affichage message
function addMessage(text, sender = "bot") {
  const msg = document.createElement("div");
  msg.className = sender === "user" ? "text-right" : "text-left";
  msg.innerHTML = `<div class="inline-block px-3 py-2 rounded-xl ${sender === "user" ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-900'}">${text}</div>`;
  messagesContainer.appendChild(msg);
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Fonction recherche rÃ©ponse FAQ
function findAnswer(question) {
  const key = question.toLowerCase().trim();
  const base = faq[currentLang];
  for (let k in base) {
    if (key.includes(k.split(" ")[0]) || key === k) {
      return base[k];
    }
  }
  return currentLang === "fr"
    ? "Je n'ai pas de rÃ©ponse exacte, mais je peux vous aider sur l'IA et la finance."
    : currentLang === "en"
    ? "I donâ€™t have an exact answer, but I can assist you with AI and finance."
    : "Ich habe keine genaue Antwort, aber ich kann Ihnen bei KI und Finanzen helfen.";
}

// Fonction utilitaire bouton question rapide
function addQuickQuestionButton(q) {
  const btn = document.createElement("button");
  btn.className = "px-3 py-1 bg-gray-200 rounded-full text-sm hover:bg-gray-300";
  btn.textContent = q;
  btn.onclick = () => {
    addMessage(q, "user");
    setTimeout(() => addMessage(findAnswer(q), "bot"), 400);
  };
  faqQuick.appendChild(btn);
}

// Questions rapides
function renderQuickQuestions() {
  faqQuick.innerHTML = "";
  faqTitle.textContent =
    currentLang === "fr" ? "Questions rapides" :
    currentLang === "en" ? "Quick questions" : "Schnellfragen";

  let list = expanded ? quickQuestions[currentLang] : quickQuestions[currentLang].slice(0, 3);
  list.forEach(q => addQuickQuestionButton(q));

  const toggleBtn = document.createElement("button");
  toggleBtn.textContent = expanded
    ? (currentLang === "fr" ? "Voir moins â–´" : currentLang === "en" ? "See less â–´" : "Weniger anzeigen â–´")
    : (currentLang === "fr" ? "Voir plus â–¾" : currentLang === "en" ? "See more â–¾" : "Mehr anzeigen â–¾");
  toggleBtn.className = "px-3 py-1 bg-blue-500 text-white rounded-full text-sm hover:bg-blue-600";
  toggleBtn.onclick = () => {
    expanded = !expanded;
    renderQuickQuestions();
  };
  faqQuick.appendChild(toggleBtn);
}

// Changement de langue
langSelect.addEventListener("change", (e) => {
  currentLang = e.target.value;
  expanded = false;

  // Reset conversation
  messagesContainer.innerHTML = "";

  // RÃ©affiche bienvenue dans la bonne langue
  if (currentLang === "fr") {
    addMessage("Bonjour ðŸ‘‹ Je suis votre assistant IA. Posez-moi une question !");
  } else if (currentLang === "en") {
    addMessage("Hello ðŸ‘‹ I am your AI assistant. Ask me a question!");
  } else {
    addMessage("Hallo ðŸ‘‹ Ich bin Ihr KI-Assistent. Stellen Sie mir eine Frage!");
  }

  renderQuickQuestions();
});

// Initialisation
renderQuickQuestions();
addMessage("Bonjour ðŸ‘‹ Je suis votre assistant IA. Posez-moi une question !", "bot");
</script>

</body>
</html>
