<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HelveticBot</title>
  <link rel="icon" type="image/svg+xml" href="Switzerland.svg">
  
  <style>
   body {
  background: rgba(255, 255, 255, 0.92) !important;
  backdrop-filter: blur(8px);
}
    .chat-container { height: calc(100vh - 180px); }
    .fade-in-up { animation: fadeInUp 0.5s ease-out; }
    @keyframes fadeInUp {
      from { opacity:0; transform:translateY(20px); }
      to { opacity:1; transform:translateY(0); }
    }
  </style>
</head>

<body class="bg-transparent">

  <!-- Header -->
  <div class="bg-white shadow-lg border-b border-blue-100 flex justify-between items-center p-3">
    <div class="flex items-center space-x-2">
      <span class="text-2xl">ğŸ‡¨ğŸ‡­</span>
      <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent">
        HelveticBot
      </h1>
    </div>

    <!-- SÃ©lecteur de langue -->
    <select id="langSelect" class="border rounded p-1 text-sm">
      <option value="fr">ğŸ‡«ğŸ‡· FR</option>
      <option value="en">ğŸ‡¬ğŸ‡§ EN</option>
      <option value="de">ğŸ‡©ğŸ‡ª DE</option>
    </select>

    <button onclick="closeWindow()" class="text-red-500 font-bold text-lg ml-3">âœ–</button>
  </div>

  <!-- Chat Container -->
  <div class="flex flex-col chat-container max-w-4xl mx-auto bg-transparent">
    <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-6"></div>

    <!-- Input -->
    <div class="border-t border-gray-200 bg-white p-3 flex items-end space-x-3">
      <textarea id="userInput" placeholder="Posez votre question..." class="flex-1 p-3 border rounded-2xl focus:ring-2 focus:ring-blue-500 resize-none"></textarea>
      <button id="sendBtn" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-3 rounded-2xl">â¤</button>
    </div>
  </div>

  <!-- Footer -->
  <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-2 text-center text-xs">
    âš¡ Powered by Helvetic AI â€¢ Secure Data
  </div>

  <script>
    const chatMessages = document.getElementById("chatMessages");
    const userInput = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");
    const langSelect = document.getElementById("langSelect");

    // === Textes multilingues ===
    const messages = {
      fr: {
        welcome: "Bonjour ğŸ‘‹ Je suis <strong class='text-blue-800'>HelveticBot</strong>, votre assistant IA financier <img src='Switzerland.svg' alt='CH' style='width:16px; height:16px; margin-left:4px; vertical-align:middle;'><br><br> Je peux vous aider avec :<br>â€¢ Analyses financiÃ¨res ğŸ“Š<br>â€¢ PrÃ©visions budgÃ©taires ğŸ“ˆ<br>â€¢ Gestion des risques âš ï¸<br>â€¢ Investissements ğŸ’¡<br>â€¢ FiscalitÃ© ğŸ“‘",
        default: "ğŸ¤– Je suis HelveticBot ğŸ‡¨ğŸ‡­ spÃ©cialisÃ© en finance. Posez-moi vos questions sur :<br>â€¢ Budget<br>â€¢ Analyse<br>â€¢ Investissements<br>â€¢ Risques<br>â€¢ FiscalitÃ©",
        budget: "ğŸ“ˆ <b>PrÃ©visions budgÃ©taires</b><br>â€¢ Analyse des flux de trÃ©sorerie<br>â€¢ ScÃ©narios optimistes/prudents<br>â€¢ ModÃ¨les prÃ©dictifs IA pour anticiper vos besoins",
        analyse: "ğŸ“Š <b>Analyse financiÃ¨re</b><br>â€¢ Ratios de rentabilitÃ© & solvabilitÃ©<br>â€¢ Marges & performance<br>â€¢ Comparaison sectorielle (benchmark)",
        investissement: "ğŸ’¡ <b>Conseil en investissement</b><br>â€¢ Diversification de portefeuille<br>â€¢ Allocation dâ€™actifs (actions, obligations, immobilier, crypto)<br>â€¢ Simulations de rendement",
        risque: "âš ï¸ <b>Gestion des risques</b><br>â€¢ Risques financiers (taux, change, liquiditÃ©)<br>â€¢ Risques opÃ©rationnels<br>â€¢ Stress tests & stratÃ©gies de couverture",
        fiscalite: "ğŸ“‘ <b>Optimisation fiscale</b><br>â€¢ Planification fiscale dâ€™entreprise<br>â€¢ DÃ©ductions et amortissements<br>â€¢ ConformitÃ© suisse et internationale"
      },
      en: {
        welcome: "Hello ğŸ‘‹ I am <strong class='text-blue-800'>HelveticBot</strong>, your financial AI assistant <img src='Switzerland.svg' alt='CH' style='width:16px; height:16px; margin-left:4px; vertical-align:middle;'><br><br>I can help you with:<br>â€¢ Financial analysis ğŸ“Š<br>â€¢ Budget forecasts ğŸ“ˆ<br>â€¢ Risk management âš ï¸<br>â€¢ Investments ğŸ’¡<br>â€¢ Taxation ğŸ“‘",
        default: "ğŸ¤– I am HelveticBot ğŸ‡¨ğŸ‡­ specialized in finance. Ask me about:<br>â€¢ Budgeting<br>â€¢ Analysis<br>â€¢ Investments<br>â€¢ Risks<br>â€¢ Taxation",
        budget: "ğŸ“ˆ <b>Budget Forecasting</b><br>â€¢ Cashflow analysis<br>â€¢ Optimistic/prudent scenarios<br>â€¢ AI predictive models to anticipate needs",
        analyse: "ğŸ“Š <b>Financial Analysis</b><br>â€¢ Profitability & solvency ratios<br>â€¢ Margins & performance<br>â€¢ Industry benchmarking",
        investissement: "ğŸ’¡ <b>Investment Advisory</b><br>â€¢ Portfolio diversification<br>â€¢ Asset allocation (stocks, bonds, real estate, crypto)<br>â€¢ Return simulations",
        risque: "âš ï¸ <b>Risk Management</b><br>â€¢ Financial risks (rates, FX, liquidity)<br>â€¢ Operational risks<br>â€¢ Stress tests & hedging strategies",
        fiscalite: "ğŸ“‘ <b>Tax Optimization</b><br>â€¢ Corporate tax planning<br>â€¢ Deductions & depreciation<br>â€¢ Swiss & international compliance"
      },
      de: {
        welcome: "Hallo ğŸ‘‹ Ich bin <strong class='text-blue-800'>HelveticBot</strong>, Ihr Finanz-KI-Assistent <img src='Switzerland.svg' alt='CH' style='width:16px; height:16px; margin-left:4px; vertical-align:middle;'><br><br>Ich kann Ihnen helfen mit:<br>â€¢ Finanzanalysen ğŸ“Š<br>â€¢ Budgetprognosen ğŸ“ˆ<br>â€¢ Risikomanagement âš ï¸<br>â€¢ Investitionen ğŸ’¡<br>â€¢ Steuern ğŸ“‘",
        default: "ğŸ¤– Ich bin HelveticBot ğŸ‡¨ğŸ‡­ spezialisiert auf Finanzen. Fragen Sie mich Ã¼ber:<br>â€¢ Budget<br>â€¢ Analyse<br>â€¢ Investitionen<br>â€¢ Risiken<br>â€¢ Steuern",
        budget: "ğŸ“ˆ <b>Budgetprognosen</b><br>â€¢ Cashflow-Analyse<br>â€¢ Optimistische/vorsichtige Szenarien<br>â€¢ KI-Modelle zur Bedarfsprognose",
        analyse: "ğŸ“Š <b>Finanzanalyse</b><br>â€¢ RentabilitÃ¤ts- & Solvenzkennzahlen<br>â€¢ Margen & Leistung<br>â€¢ Branchen-Benchmarking",
        investissement: "ğŸ’¡ <b>Investitionen</b><br>â€¢ Portfoliodiversifikation<br>â€¢ Asset Allocation (Aktien, Anleihen, Immobilien, Krypto)<br>â€¢ Renditesimulationen",
        risque: "âš ï¸ <b>Risikomanagement</b><br>â€¢ Finanzrisiken (Zinsen, Wechselkurse, LiquiditÃ¤t)<br>â€¢ Operative Risiken<br>â€¢ Stresstests & Absicherungsstrategien",
        fiscalite: "ğŸ“‘ <b>Steueroptimierung</b><br>â€¢ Unternehmenssteuerplanung<br>â€¢ AbzÃ¼ge & Abschreibungen<br>â€¢ Schweizer & internationale Compliance"
      }
    };

    let currentLang = "fr";

    function addMessage(type, content) {
      const div = document.createElement("div");
      div.className = `flex ${type === "user" ? "justify-end" : "justify-start"} fade-in-up`;
      const bubble = document.createElement("div");
      bubble.className = `${type === "user" ? "bg-gray-700 text-white" : "bg-white border border-blue-100"} rounded-2xl p-4 shadow-lg max-w-xl`;
      bubble.innerHTML = content;
      div.appendChild(bubble);
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function botResponse(msg) {
      msg = msg.toLowerCase();

      if (msg.includes("budget") || msg.includes("forecast") || msg.includes("prognose")) return messages[currentLang].budget;
      if (msg.includes("analyse") || msg.includes("analysis")) return messages[currentLang].analyse;
      if (msg.includes("invest") || msg.includes("investment") || msg.includes("investition")) return messages[currentLang].investissement;
      if (msg.includes("risque") || msg.includes("risk")) return messages[currentLang].risque;
      if (msg.includes("fiscal") || msg.includes("tax") || msg.includes("steuer")) return messages[currentLang].fiscalite;

      return messages[currentLang].default;
    }

    function sendMessage() {
      const text = userInput.value.trim();
      if (!text) return;
      addMessage("user", text);
      userInput.value = "";
      setTimeout(() => {
        addMessage("bot", botResponse(text));
      }, 800);
    }

    sendBtn.addEventListener("click", sendMessage);
    userInput.addEventListener("keypress", e => {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    // Changement de langue
    langSelect.addEventListener("change", () => {
      currentLang = langSelect.value;
      chatMessages.innerHTML = "";
      addMessage("bot", messages[currentLang].welcome);
    });

    // Init
    addMessage("bot", messages[currentLang].welcome);

    // === Fonction close ===
    function closeWindow() {
      if (window.parent) {
        window.parent.postMessage({ action: "closeChatbot" }, "*");
      }
    }
  </script>
</body>
</html>
