<title>Helvitic AI - Chatbot Avanc√©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
        }
        .pulse-glow { animation: pulse-glow 2s infinite; }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .slide-up { animation: slideUp 0.3s ease-out; }
        
        @keyframes typing {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        .typing-indicator { animation: typing 1s infinite; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
        
        .message-user {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        
        .message-bot {
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            border: 1px solid #d1d5db;
        }
        
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f1f5f9; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
        
        .language-btn {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .language-btn:hover {
            transform: scale(1.05);
            border-color: #3b82f6;
        }
        .language-btn.selected {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Chatbot Container -->
    <div id="chatbot-container" class="fixed bottom-5 right-5 z-50">
        <!-- Notification Badge -->
        <div id="notification-badge" class="absolute -top-2 -left-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs font-bold hidden">
            <span id="notification-count">1</span>
        </div>
        
        <!-- Toggle Button -->
        <button id="chatbot-toggle" class="w-16 h-16 rounded-full gradient-bg flex items-center justify-center shadow-2xl hover:scale-110 transition-all duration-300 pulse-glow">
            <span id="toggle-icon" class="text-2xl">ü§ñ</span>
        </button>

        <!-- Chat Window -->
        <div id="chatbot-window" class="hidden absolute bottom-20 right-0 w-96 h-[600px] glass-effect rounded-3xl shadow-2xl flex flex-col border border-white/20">
            <!-- Header -->
            <div class="gradient-bg text-white flex justify-between items-center p-4 rounded-t-3xl">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
                        <span class="text-lg">üöÄ</span>
                    </div>
                    <div>
                        <div class="font-bold">Helvitic AI</div>
                        <div class="text-xs opacity-80" id="status">En ligne</div>
                    </div>
                </div>
                <div class="flex space-x-2">
                    <button id="language-selector" class="w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors" title="Changer de langue">
                        üåç
                    </button>
                    <button id="clear-chat" class="w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors" title="Effacer la conversation">
                        üóëÔ∏è
                    </button>
                    <button id="chatbot-close" class="w-8 h-8 hover:bg-white/20 rounded-full flex items-center justify-center transition-colors">
                        ‚úï
                    </button>
                </div>
            </div>

            <!-- Language Selection Modal -->
            <div id="language-modal" class="absolute inset-0 bg-black/50 rounded-3xl flex items-center justify-center z-10">
                <div class="bg-white p-6 rounded-2xl shadow-xl max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold text-center mb-4">Choose your language / Choisissez votre langue / W√§hlen Sie Ihre Sprache</h3>
                    <div class="space-y-3">
                        <button class="language-btn w-full p-3 bg-gray-100 rounded-xl flex items-center space-x-3 hover:bg-gray-200" data-lang="fr">
                            <span class="text-2xl">üá´üá∑</span>
                            <div class="text-left">
                                <div class="font-semibold">Fran√ßais</div>
                                <div class="text-sm text-gray-600">Langue fran√ßaise</div>
                            </div>
                        </button>
                        <button class="language-btn w-full p-3 bg-gray-100 rounded-xl flex items-center space-x-3 hover:bg-gray-200" data-lang="en">
                            <span class="text-2xl">üá¨üáß</span>
                            <div class="text-left">
                                <div class="font-semibold">English</div>
                                <div class="text-sm text-gray-600">English language</div>
                            </div>
                        </button>
                        <button class="language-btn w-full p-3 bg-gray-100 rounded-xl flex items-center space-x-3 hover:bg-gray-200" data-lang="de">
                            <span class="text-2xl">üá©üá™</span>
                            <div class="text-left">
                                <div class="font-semibold">Deutsch</div>
                                <div class="text-sm text-gray-600">Deutsche Sprache</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Messages Container -->
            <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 space-y-3 scrollbar-thin">
                <!-- Messages will be populated by JavaScript -->
            </div>

            <!-- Typing Indicator -->
            <div id="typing-indicator" class="hidden px-4 pb-2">
                <div class="flex items-center space-x-2 text-gray-500 text-sm">
                    <div class="w-6 h-6 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white text-xs">
                        AI
                    </div>
                    <span id="typing-text">Assistant √©crit</span>
                    <span class="typing-indicator">...</span>
                </div>
            </div>

            <!-- Quick Actions -->
            <div id="quick-actions" class="px-4 pb-2">
                <div class="flex space-x-2 overflow-x-auto scrollbar-thin">
                    <button class="quick-action-btn flex-shrink-0 bg-blue-100 hover:bg-blue-200 px-3 py-1 rounded-full text-xs transition-colors" data-action="services">
                        üöÄ Services
                    </button>
                    <button class="quick-action-btn flex-shrink-0 bg-green-100 hover:bg-green-200 px-3 py-1 rounded-full text-xs transition-colors" data-action="demo">
                        ‚ú® D√©mo
                    </button>
                    <button class="quick-action-btn flex-shrink-0 bg-purple-100 hover:bg-purple-200 px-3 py-1 rounded-full text-xs transition-colors" data-action="contact">
                        üìû Contact
                    </button>
                </div>
            </div>

            <!-- Input Area -->
            <div class="border-t border-gray-200 p-4">
                <div class="flex items-center space-x-3">
                    <div class="flex-1 relative">
                        <input 
                            type="text" 
                            id="user-input" 
                            placeholder="Tapez votre message..." 
                            class="w-full px-4 py-3 rounded-2xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                            maxlength="500"
                        >
                        <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-400" id="char-count">
                            0/500
                        </div>
                    </div>
                    <button id="send-btn" class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-full flex items-center justify-center hover:scale-105 transition-transform disabled:opacity-50">
                        <span id="send-icon">üì§</span>
                    </button>
                </div>
                
                <!-- Suggestions -->
                <div id="suggestions" class="mt-2 space-y-1"></div>
            </div>

            <!-- Footer -->
            <div class="px-4 pb-3 text-center">
                <div class="text-xs text-gray-500">
                    <span id="powered-by">Aliment√© par</span> <span class="font-semibold text-blue-600">Helvitic AI</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration multilingue
        const languages = {
            fr: {
                name: "Fran√ßais",
                flag: "üá´üá∑",
                welcome: "üëã Bonjour ! Je suis votre assistant virtuel Helvitic AI. Comment puis-je vous aider aujourd'hui ?",
                typing: "Assistant √©crit",
                placeholder: "Tapez votre message...",
                poweredBy: "Aliment√© par",
                status: "En ligne",
                clearTitle: "Effacer la conversation",
                langTitle: "Changer de langue",
                clearConfirm: "üßπ Conversation effac√©e ! Comment puis-je vous aider ?",
                quickActions: {
                    services: "üöÄ Services",
                    demo: "‚ú® D√©mo", 
                    contact: "üìû Contact"
                }
            },
            en: {
                name: "English",
                flag: "üá¨üáß", 
                welcome: "üëã Hello! I'm your virtual assistant Helvitic AI. How can I help you today?",
                typing: "Assistant is typing",
                placeholder: "Type your message...",
                poweredBy: "Powered by",
                status: "Online",
                clearTitle: "Clear conversation",
                langTitle: "Change language",
                clearConfirm: "üßπ Conversation cleared! How can I help you?",
                quickActions: {
                    services: "üöÄ Services",
                    demo: "‚ú® Demo",
                    contact: "üìû Contact"
                }
            },
            de: {
                name: "Deutsch",
                flag: "üá©üá™",
                welcome: "üëã Hallo! Ich bin Ihr virtueller Assistent Helvitic AI. Wie kann ich Ihnen heute helfen?",
                typing: "Assistent schreibt",
                placeholder: "Geben Sie Ihre Nachricht ein...",
                poweredBy: "Betrieben von",
                status: "Online",
                clearTitle: "Unterhaltung l√∂schen",
                langTitle: "Sprache √§ndern",
                clearConfirm: "üßπ Unterhaltung gel√∂scht! Wie kann ich Ihnen helfen?",
                quickActions: {
                    services: "üöÄ Services",
                    demo: "‚ú® Demo",
                    contact: "üìû Kontakt"
                }
            }
        };

        // Base de connaissances multilingue
        const knowledgeBase = {
            fr: {
                services: {
                    keywords: ["service", "proposez", "offrez", "faites", "solutions", "produits"],
                    responses: [
                        "üöÄ **Nos services principaux :**\n‚Ä¢ Automatisation intelligente\n‚Ä¢ Analyse de donn√©es avanc√©e\n‚Ä¢ IA personnalis√©e\n‚Ä¢ Conseil en transformation digitale\n‚Ä¢ Formation et accompagnement",
                        "üíº Nous proposons des solutions compl√®tes d'IA : automatisation, analyse pr√©dictive, chatbots, vision par ordinateur et bien plus encore !",
                        "‚ö° D√©couvrez nos services : d√©veloppement sur mesure, int√©gration d'IA, optimisation de processus et support technique complet."
                    ]
                },
                contact: {
                    keywords: ["contact", "joindre", "appeler", "email", "t√©l√©phone", "rendez-vous"],
                    responses: [
                        "üì© **Contactez-nous :**\n‚Ä¢ Email: contact@helvitic.ai\n‚Ä¢ Site: www.helvitic.ai\n‚Ä¢ R√©ponse sous 24h garantie !",
                        "‚òéÔ∏è Plusieurs moyens de nous contacter : email, formulaire en ligne ou demande de rappel. Nous r√©pondons rapidement !",
                        "üìû Notre √©quipe est disponible du lundi au vendredi. Contactez-nous via notre site web pour un premier √©change gratuit."
                    ]
                },
                demo: {
                    keywords: ["d√©mo", "test", "essai", "gratuit", "exemple", "voir"],
                    responses: [
                        "‚ú® **D√©mo gratuite disponible !**\n‚Ä¢ G√©n√©rateur de prompts interactif\n‚Ä¢ Exemples de solutions IA\n‚Ä¢ Consultation personnalis√©e",
                        "üéÅ Testez gratuitement notre g√©n√©rateur de prompts et d√©couvrez le potentiel de l'IA pour votre entreprise !",
                        "üÜì D√©mo gratuite de 30 minutes incluant : pr√©sentation personnalis√©e, Q&R et recommandations sp√©cifiques."
                    ]
                },
                defaultResponses: [
                    "ü§î Int√©ressant ! Pouvez-vous me donner plus de d√©tails pour que je puisse mieux vous aider ?",
                    "üí° Je pense pouvoir vous aider ! Reformulez votre question pour que je comprenne mieux vos besoins.",
                    "üéØ Cette question m√©rite une r√©ponse personnalis√©e. Contactez-nous directement pour un √©change approfondi !"
                ],
                suggestions: [
                    "Quels sont vos services ?",
                    "Comment vous contacter ?",
                    "Avez-vous une d√©mo gratuite ?",
                    "Quels sont vos tarifs ?",
                    "Proposez-vous du conseil en IA ?",
                    "Pouvez-vous automatiser mes t√¢ches ?"
                ]
            },
            en: {
                services: {
                    keywords: ["service", "offer", "provide", "do", "solutions", "products"],
                    responses: [
                        "üöÄ **Our main services:**\n‚Ä¢ Intelligent automation\n‚Ä¢ Advanced data analysis\n‚Ä¢ Custom AI\n‚Ä¢ Digital transformation consulting\n‚Ä¢ Training and support",
                        "üíº We offer complete AI solutions: automation, predictive analysis, chatbots, computer vision and much more!",
                        "‚ö° Discover our services: custom development, AI integration, process optimization and complete technical support."
                    ]
                },
                contact: {
                    keywords: ["contact", "reach", "call", "email", "phone", "appointment"],
                    responses: [
                        "üì© **Contact us:**\n‚Ä¢ Email: contact@helvitic.ai\n‚Ä¢ Website: www.helvitic.ai\n‚Ä¢ 24h response guaranteed!",
                        "‚òéÔ∏è Several ways to contact us: email, online form or callback request. We respond quickly!",
                        "üìû Our team is available Monday to Friday. Contact us via our website for a free initial consultation."
                    ]
                },
                demo: {
                    keywords: ["demo", "test", "trial", "free", "example", "see"],
                    responses: [
                        "‚ú® **Free demo available!**\n‚Ä¢ Interactive prompt generator\n‚Ä¢ AI solution examples\n‚Ä¢ Personalized consultation",
                        "üéÅ Test our prompt generator for free and discover AI's potential for your business!",
                        "üÜì Free 30-minute demo including: personalized presentation, Q&A and specific recommendations."
                    ]
                },
                defaultResponses: [
                    "ü§î Interesting! Can you give me more details so I can better help you?",
                    "üí° I think I can help you! Please rephrase your question so I can better understand your needs.",
                    "üéØ This question deserves a personalized answer. Contact us directly for an in-depth discussion!"
                ],
                suggestions: [
                    "What are your services?",
                    "How to contact you?",
                    "Do you have a free demo?",
                    "What are your rates?",
                    "Do you offer AI consulting?",
                    "Can you automate my tasks?"
                ]
            },
            de: {
                services: {
                    keywords: ["service", "anbieten", "bieten", "machen", "l√∂sungen", "produkte"],
                    responses: [
                        "üöÄ **Unsere Hauptdienstleistungen:**\n‚Ä¢ Intelligente Automatisierung\n‚Ä¢ Erweiterte Datenanalyse\n‚Ä¢ Personalisierte KI\n‚Ä¢ Beratung zur digitalen Transformation\n‚Ä¢ Schulung und Begleitung",
                        "üíº Wir bieten komplette KI-L√∂sungen: Automatisierung, pr√§diktive Analyse, Chatbots, Computer Vision und vieles mehr!",
                        "‚ö° Entdecken Sie unsere Services: ma√ügeschneiderte Entwicklung, KI-Integration, Prozessoptimierung und umfassender technischer Support."
                    ]
                },
                contact: {
                    keywords: ["kontakt", "erreichen", "anrufen", "email", "telefon", "termin"],
                    responses: [
                        "üì© **Kontaktieren Sie uns:**\n‚Ä¢ Email: contact@helvitic.ai\n‚Ä¢ Website: www.helvitic.ai\n‚Ä¢ 24h Antwort garantiert!",
                        "‚òéÔ∏è Mehrere Wege uns zu kontaktieren: E-Mail, Online-Formular oder R√ºckrufwunsch. Wir antworten schnell!",
                        "üìû Unser Team ist Montag bis Freitag verf√ºgbar. Kontaktieren Sie uns √ºber unsere Website f√ºr eine kostenlose Erstberatung."
                    ]
                },
                demo: {
                    keywords: ["demo", "test", "probe", "kostenlos", "beispiel", "sehen"],
                    responses: [
                        "‚ú® **Kostenlose Demo verf√ºgbar!**\n‚Ä¢ Interaktiver Prompt-Generator\n‚Ä¢ KI-L√∂sungsbeispiele\n‚Ä¢ Personalisierte Beratung",
                        "üéÅ Testen Sie unseren Prompt-Generator kostenlos und entdecken Sie das KI-Potenzial f√ºr Ihr Unternehmen!",
                        "üÜì Kostenlose 30-min√ºtige Demo mit: personalisierter Pr√§sentation, Q&A und spezifischen Empfehlungen."
                    ]
                },
                defaultResponses: [
                    "ü§î Interessant! K√∂nnen Sie mir mehr Details geben, damit ich Ihnen besser helfen kann?",
                    "üí° Ich denke, ich kann Ihnen helfen! Formulieren Sie Ihre Frage um, damit ich Ihre Bed√ºrfnisse besser verstehe.",
                    "üéØ Diese Frage verdient eine personalisierte Antwort. Kontaktieren Sie uns direkt f√ºr ein ausf√ºhrliches Gespr√§ch!"
                ],
                suggestions: [
                    "Was sind Ihre Services?",
                    "Wie kann ich Sie kontaktieren?",
                    "Haben Sie eine kostenlose Demo?",
                    "Was sind Ihre Preise?",
                    "Bieten Sie KI-Beratung an?",
                    "K√∂nnen Sie meine Aufgaben automatisieren?"
                ]
            }
        };

        // Variables globales
        let currentLanguage = null;
        let conversationHistory = [];
        let isTyping = false;
        let suggestionIndex = 0;

        // √âl√©ments DOM
        const toggleBtn = document.getElementById("chatbot-toggle");
        const chatWindow = document.getElementById("chatbot-window");
        const closeBtn = document.getElementById("chatbot-close");
        const clearBtn = document.getElementById("clear-chat");
        const messagesDiv = document.getElementById("chatbot-messages");
        const userInput = document.getElementById("user-input");
        const sendBtn = document.getElementById("send-btn");
        const typingIndicator = document.getElementById("typing-indicator");
        const charCount = document.getElementById("char-count");
        const suggestionsDiv = document.getElementById("suggestions");
        const notificationBadge = document.getElementById("notification-badge");
        const languageModal = document.getElementById("language-modal");
        const languageSelector = document.getElementById("language-selector");

        // Initialisation
        function init() {
            setupEventListeners();
            // Ne pas masquer le modal de langue au d√©but
        }

        // Configuration des √©couteurs d'√©v√©nements
        function setupEventListeners() {
            toggleBtn.addEventListener("click", toggleChat);
            closeBtn.addEventListener("click", closeChat);
            clearBtn.addEventListener("click", clearConversation);
            sendBtn.addEventListener("click", sendMessage);
            userInput.addEventListener("keypress", handleKeyPress);
            userInput.addEventListener("input", updateCharCount);
            languageSelector.addEventListener("click", showLanguageModal);
            
            // Language selection
            document.querySelectorAll(".language-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    const lang = e.currentTarget.dataset.lang;
                    selectLanguage(lang);
                });
            });
            
            // Quick actions
            document.querySelectorAll(".quick-action-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    const action = e.target.dataset.action;
                    handleQuickAction(action);
                });
            });
        }

        // S√©lectionner langue
        function selectLanguage(lang) {
            currentLanguage = lang;
            languageModal.classList.add("hidden");
            
            // Mettre √† jour l'interface
            updateInterface();
            
            // Afficher le message de bienvenue
            showWelcomeMessage();
            
            // Afficher les suggestions
            showSuggestions();
        }

        // Mettre √† jour l'interface selon la langue
        function updateInterface() {
            const config = languages[currentLanguage];
            
            document.getElementById("status").textContent = config.status;
            document.getElementById("typing-text").textContent = config.typing;
            document.getElementById("user-input").placeholder = config.placeholder;
            document.getElementById("powered-by").textContent = config.poweredBy;
            document.getElementById("clear-chat").title = config.clearTitle;
            document.getElementById("language-selector").title = config.langTitle;
            
            // Mettre √† jour les boutons d'action rapide
            const quickBtns = document.querySelectorAll(".quick-action-btn");
            quickBtns[0].innerHTML = config.quickActions.services;
            quickBtns[1].innerHTML = config.quickActions.demo;
            quickBtns[2].innerHTML = config.quickActions.contact;
        }

        // Afficher message de bienvenue
        function showWelcomeMessage() {
            messagesDiv.innerHTML = "";
            const config = languages[currentLanguage];
            
            const messageEl = document.createElement("div");
            messageEl.className = "flex items-start space-x-2 slide-up";
            messageEl.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                    AI
                </div>
                <div class="message-bot px-4 py-2 rounded-2xl rounded-tl-sm max-w-72 text-sm">
                    ${formatMessage(message)}
                </div>
            `;
            messagesDiv.appendChild(messageEl);
            scrollToBottom();
        }

        // G√©n√©ration de r√©ponse intelligente multilingue
        function generateResponse(message) {
            const lowerMessage = message.toLowerCase();
            const langData = knowledgeBase[currentLanguage];
            
            // Recherche dans la base de connaissances
            for (const [category, data] of Object.entries(langData)) {
                if (category === 'defaultResponses' || category === 'suggestions') continue;
                
                for (const keyword of data.keywords) {
                    if (lowerMessage.includes(keyword)) {
                        const responses = data.responses;
                        return responses[Math.floor(Math.random() * responses.length)];
                    }
                }
            }

            // R√©ponses contextuelles multilingues
            const contextualResponses = {
                fr: {
                    thanks: ["merci", "remercie"],
                    response: "üòä Avec plaisir ! N'h√©sitez pas si vous avez d'autres questions."
                },
                en: {
                    thanks: ["thank", "thanks"],
                    response: "üòä You're welcome! Don't hesitate if you have other questions."
                },
                de: {
                    thanks: ["danke", "dank"],
                    response: "üòä Gern geschehen! Z√∂gern Sie nicht, wenn Sie weitere Fragen haben."
                }
            };

            const goodbyeResponses = {
                fr: {
                    keywords: ["au revoir", "bye", "salut", "√† bient√¥t"],
                    response: "üëã Au revoir ! N'h√©sitez pas √† revenir quand vous voulez. Bonne journ√©e !"
                },
                en: {
                    keywords: ["goodbye", "bye", "see you", "farewell"],
                    response: "üëã Goodbye! Don't hesitate to come back anytime. Have a great day!"
                },
                de: {
                    keywords: ["auf wiedersehen", "bye", "tsch√ºss", "bis bald"],
                    response: "üëã Auf Wiedersehen! Z√∂gern Sie nicht, jederzeit zur√ºckzukommen. Haben Sie einen sch√∂nen Tag!"
                }
            };

            // V√©rifier les remerciements
            const thanks = contextualResponses[currentLanguage];
            for (const keyword of thanks.thanks) {
                if (lowerMessage.includes(keyword)) {
                    return thanks.response;
                }
            }

            // V√©rifier les au revoir
            const goodbye = goodbyeResponses[currentLanguage];
            for (const keyword of goodbye.keywords) {
                if (lowerMessage.includes(keyword)) {
                    return goodbye.response;
                }
            }

            // R√©ponse par d√©faut
            const defaultResponses = langData.defaultResponses;
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        // Formattage des messages
        function formatMessage(message) {
            return message
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>')
                .replace(/‚Ä¢/g, '<span style="color: #3b82f6;">‚Ä¢</span>');
        }

        // √âchapper HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Afficher indicateur de frappe
        function showTypingIndicator() {
            isTyping = true;
            typingIndicator.classList.remove("hidden");
            scrollToBottom();
        }

        // Masquer indicateur de frappe
        function hideTypingIndicator() {
            isTyping = false;
            typingIndicator.classList.add("hidden");
        }

        // D√©filer vers le bas
        function scrollToBottom() {
            setTimeout(() => {
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }, 100);
        }

        // Afficher suggestions
        function showSuggestions() {
            if (!currentLanguage) return;
            
            suggestionsDiv.innerHTML = "";
            const suggestions = knowledgeBase[currentLanguage].suggestions;
            const currentSuggestions = suggestions.slice(suggestionIndex, suggestionIndex + 3);
            
            currentSuggestions.forEach(suggestion => {
                const btn = document.createElement("button");
                btn.className = "w-full text-left px-3 py-2 bg-gray-50 hover:bg-blue-50 rounded-lg text-xs transition-colors border border-gray-200";
                btn.textContent = suggestion;
                btn.onclick = () => {
                    userInput.value = suggestion;
                    sendMessage();
                };
                suggestionsDiv.appendChild(btn);
            });
        }

        // Masquer suggestions
        function hideSuggestions() {
            suggestionsDiv.innerHTML = "";
        }

        // Mettre √† jour suggestions
        function updateSuggestions() {
            if (!currentLanguage) return;
            
            const suggestions = knowledgeBase[currentLanguage].suggestions;
            suggestionIndex = (suggestionIndex + 3) % suggestions.length;
            showSuggestions();
        }

        // Afficher notification
        function showNotification() {
            if (chatWindow.classList.contains("hidden")) {
                notificationBadge.classList.remove("hidden");
            }
        }

        // Masquer notification
        function hideNotification() {
            notificationBadge.classList.add("hidden");
        }

        // Initialiser l'application
        init();

    </script>
</body>
</html> text-sm">
                    ${config.welcome}
                </div>
            `;
            messagesDiv.appendChild(messageEl);
        }

        // Afficher modal de langue
        function showLanguageModal() {
            languageModal.classList.remove("hidden");
        }

        // Toggle chat
        function toggleChat() {
            const isHidden = chatWindow.classList.contains("hidden");
            if (isHidden) {
                chatWindow.classList.remove("hidden");
                chatWindow.classList.add("slide-up");
                
                if (!currentLanguage) {
                    languageModal.classList.remove("hidden");
                } else {
                    userInput.focus();
                }
                
                hideNotification();
            } else {
                closeChat();
            }
        }

        // Fermer chat
        function closeChat() {
            chatWindow.classList.add("hidden");
        }

        // Effacer conversation
        function clearConversation() {
            if (!currentLanguage) return;
            
            conversationHistory = [];
            const config = languages[currentLanguage];
            
            messagesDiv.innerHTML = `
                <div class="flex items-start space-x-2 slide-up">
                    <div class="w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                        AI
                    </div>
                    <div class="message-bot px-4 py-2 rounded-2xl rounded-tl-sm max-w-72 text-sm">
                        ${config.clearConfirm}
                    </div>
                </div>
            `;
            showSuggestions();
        }

        // Gestion des touches
        function handleKeyPress(e) {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }

        // Mise √† jour compteur caract√®res
        function updateCharCount() {
            const count = userInput.value.length;
            charCount.textContent = `${count}/500`;
            charCount.style.color = count > 450 ? "#ef4444" : "#9ca3af";
        }

        // Actions rapides
        function handleQuickAction(action) {
            if (!currentLanguage) return;
            
            const config = languages[currentLanguage];
            const actionQuestions = {
                fr: {
                    services: "Quels sont vos services ?",
                    demo: "Avez-vous une d√©mo gratuite ?",
                    contact: "Comment puis-je vous contacter ?"
                },
                en: {
                    services: "What are your services?",
                    demo: "Do you have a free demo?",
                    contact: "How can I contact you?"
                },
                de: {
                    services: "Was sind Ihre Services?",
                    demo: "Haben Sie eine kostenlose Demo?",
                    contact: "Wie kann ich Sie kontaktieren?"
                }
            };
            
            userInput.value = actionQuestions[currentLanguage][action] || "";
            sendMessage();
        }

        // Envoyer message
        async function sendMessage() {
            if (!currentLanguage) return;
            
            const message = userInput.value.trim();
            if (!message || isTyping) return;

            // Ajouter message utilisateur
            addUserMessage(message);
            userInput.value = "";
            updateCharCount();
            hideSuggestions();

            // Simuler frappe
            showTypingIndicator();
            
            // D√©lai r√©aliste pour la r√©ponse
            setTimeout(() => {
                const response = generateResponse(message);
                hideTypingIndicator();
                addBotMessage(response);
                updateSuggestions();
            }, 1000 + Math.random() * 2000);

            conversationHistory.push({user: message, timestamp: Date.now()});
        }

        // Ajouter message utilisateur
        function addUserMessage(message) {
            const messageEl = document.createElement("div");
            messageEl.className = "flex justify-end slide-up";
            messageEl.innerHTML = `
                <div class="message-user px-4 py-2 rounded-2xl rounded-tr-sm max-w-72 text-sm">
                    ${escapeHtml(message)}
                </div>
            `;
            messagesDiv.appendChild(messageEl);
            scrollToBottom();
        }

        // Ajouter message bot
        function addBotMessage(message) {
            const messageEl = document.createElement("div");
            messageEl.className = "flex items-start space-x-2 slide-up";
            messageEl.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold">
                    AI
                </div>
                <div class="message-bot px-4 py-2 rounded-2xl rounded-tl-sm max-w-72
