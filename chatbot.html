<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HelveticBot Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      height: 100vh;
      position: relative;
    }
    
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      pointer-events: none;
    }
    
    .chatbot-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 400px;
      height: 600px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: translateY(0);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1000;
    }
    
    .chatbot-container.minimized {
      transform: translateY(calc(100% - 60px));
    }
    
    .chatbot-container.closed {
      transform: translateY(100%);
      opacity: 0;
      pointer-events: none;
    }
    
    header {
      background: linear-gradient(45deg, #dc2626, #b91c1c);
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    header::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 30px;
      height: 30px;
      background: white;
      opacity: 0.1;
    }
    
    header::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 6px;
      height: 20px;
      background: white;
      opacity: 0.1;
      box-shadow: 
        -12px 0 0 white,
        12px 0 0 white,
        0 -7px 0 white,
        0 7px 0 white;
    }
    
    header h1 {
      font-size: 18px;
      margin: 0;
      font-weight: 600;
      text-shadow: 0 1px 3px rgba(0,0,0,0.3);
      z-index: 10;
      position: relative;
    }
    
    .swiss-flag {
      width: 24px;
      height: 24px;
      background: #dc2626;
      border: 2px solid white;
      border-radius: 2px;
      position: relative;
      margin-right: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .swiss-flag::before,
    .swiss-flag::after {
      content: '';
      position: absolute;
      background: white;
    }
    
    .swiss-flag::before {
      width: 3px;
      height: 14px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    .swiss-flag::after {
      width: 14px;
      height: 3px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    .header-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .status {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      opacity: 0.9;
    }
    
    .status-dot {
      width: 6px;
      height: 6px;
      background: #22c55e;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    .control-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    
    .control-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .chat {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
      background: transparent;
    }
    
    .message {
      margin-bottom: 15px;
      display: flex;
      align-items: flex-start;
      animation: fadeInUp 0.3s ease-out;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(15px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .message.user {
      justify-content: flex-end;
    }
    
    .avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      margin: 0 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: bold;
    }
    
    .message.bot .avatar {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      order: 0;
    }
    
    .message.user .avatar {
      background: linear-gradient(45deg, #f093fb, #f5576c);
      color: white;
      order: 1;
    }
    
    .bubble {
      padding: 12px 15px;
      border-radius: 18px;
      max-width: 75%;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      white-space: pre-wrap;
      position: relative;
    }
    
    .message.bot .bubble {
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .message.user .bubble {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
    }
    
    .typing {
      display: flex;
      gap: 3px;
      padding: 8px;
    }
    
    .typing-dot {
      width: 5px;
      height: 5px;
      background: #667eea;
      border-radius: 50%;
      animation: typing 1.4s infinite;
    }
    
    .typing-dot:nth-child(1) { animation-delay: 0ms; }
    .typing-dot:nth-child(2) { animation-delay: 200ms; }
    .typing-dot:nth-child(3) { animation-delay: 400ms; }
    
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-8px); }
    }
    
    .input-area {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      padding: 12px 15px;
      display: flex;
      gap: 8px;
    }
    
    textarea {
      flex: 1;
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 10px 12px;
      resize: none;
      font-size: 13px;
      background: rgba(255, 255, 255, 0.9);
      transition: all 0.3s ease;
      font-family: inherit;
      min-height: 36px;
      max-height: 100px;
    }
    
    textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    button.send {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 10px 16px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
    }
    
    button.send:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    button.send:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .suggestions {
      margin-top: 12px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    
    .suggestions button {
      background: rgba(102, 126, 234, 0.1);
      border: 1px solid rgba(102, 126, 234, 0.3);
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 11px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #667eea;
    }
    
    .suggestions button:hover {
      background: rgba(102, 126, 234, 0.2);
      transform: translateY(-1px);
    }
    
    footer {
      background: linear-gradient(45deg, #dc2626, #b91c1c);
      color: #fff;
      font-size: 10px;
      text-align: center;
      padding: 6px;
      position: relative;
    }
    
    footer::before {
      content: '';
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      background: #dc2626;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 1px;
    }
    
    footer::after {
      content: '';
      position: absolute;
      top: 50%;
      right: 19px;
      transform: translateY(-50%);
      width: 2px;
      height: 8px;
      background: white;
      box-shadow: 0 -3px 0 white, 0 3px 0 white, -3px 0 0 white, 3px 0 0 white;
    }
    
    .feature-pills {
      display: flex;
      gap: 6px;
      margin: 12px 0;
      flex-wrap: wrap;
    }
    
    .pill {
      background: rgba(102, 126, 234, 0.1);
      border: 1px solid rgba(102, 126, 234, 0.3);
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 10px;
      color: #667eea;
      font-weight: 500;
    }
    
    .chart-container {
      margin: 12px 0;
      padding: 12px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .mini-chart {
      width: 100%;
      height: 80px;
      background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #667eea;
      font-size: 11px;
    }
    
    .action-buttons {
      display: flex;
      gap: 6px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    
    .action-btn {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 10px;
      font-size: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
    }
    
    /* Toggle button for opening/closing */
    .chat-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: linear-gradient(45deg, #dc2626, #b91c1c);
      border: 3px solid white;
      border-radius: 50%;
      color: white;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 999;
      display: none;
      position: relative;
    }
    
    .chat-toggle::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      background: #dc2626;
      border: 1px solid white;
      border-radius: 1px;
    }
    
    .chat-toggle::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 3px;
      height: 12px;
      background: white;
      box-shadow: 
        0 -4px 0 white,
        0 4px 0 white,
        -4px 0 0 white,
        4px 0 0 white;
    }
    
    .chat-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 35px rgba(220, 38, 38, 0.4);
    }
    
    .chat-toggle.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    @media (max-width: 480px) {
      .chatbot-container {
        width: calc(100vw - 20px);
        height: calc(100vh - 40px);
        bottom: 10px;
        right: 10px;
        left: 10px;
        border-radius: 15px;
      }
      
      .chat-toggle {
        bottom: 15px;
        right: 15px;
      }
      
      .bubble {
        max-width: 85%;
      }
      
      header h1 {
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="chatbot-container" id="chatbotContainer">
    <header onclick="toggleMinimize()">
      <div style="display: flex; align-items: center;">
        <div class="swiss-flag"></div>
        <h1>HelveticBot Pro</h1>
      </div>
      <div class="header-controls">
        <div class="status">
          <div class="status-dot"></div>
          <span>🇨🇭 Online</span>
        </div>
        <button class="control-btn" onclick="event.stopPropagation(); toggleMinimize()" title="Minimize">−</button>
        <button class="control-btn" onclick="event.stopPropagation(); closeChatbot()" title="Close">×</button>
      </div>
    </header>

    <div class="chat" id="chat"></div>

    <div class="input-area">
      <textarea id="userInput" rows="1" placeholder="Ask your question about finance, analysis, or strategy..."></textarea>
      <button class="send" id="sendBtn">➤</button>
    </div>

    <footer>
      ⚡ Powered by Helvetic AI • Secure Data 🇨🇭 • v2.1 Pro
    </footer>
  </div>

  <button class="chat-toggle" id="chatToggle" onclick="openChatbot()" title="Open HelveticBot Pro">
  </button>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const chatbotContainer = document.getElementById('chatbotContainer');
    const chatToggle = document.getElementById('chatToggle');
    let messageHistory = [];
    let isTyping = false;
    let isMinimized = false;
    let isClosed = false;

    // Enhanced knowledge base in English
    const knowledgeBase = {
      analysis: {
        keywords: ["analysis", "analyze", "financial analysis", "study", "diagnostic", "examine"],
        responses: [
          {
            text: "📊 <b>Advanced Financial Analysis</b><br><br>I can assist you with:<br>• Liquidity ratio analysis<br>• Profitability study (ROE, ROA, ROIC)<br>• Working capital & cash flow analysis<br>• Industry benchmarking<br>• Performance diagnostics",
            sugg: ["Calculate ratios", "Analyze solvency", "Compare to competitors", "Industry trends"]
          },
          {
            text: "🔍 <b>In-Depth Diagnostic</b><br><br>My methodology includes:<br>• Data collection & validation<br>• Vertical & horizontal analysis<br>• Critical KPI identification<br>• Strategic recommendations",
            sugg: ["Define KPIs", "Create dashboard", "Plan actions", "Automate tracking"]
          }
        ]
      },
      budget: {
        keywords: ["budget", "forecast", "forecasting", "planning", "projection", "predict"],
        responses: [
          {
            text: "📈 <b>Intelligent Budget Forecasting</b><br><br>Available technologies:<br>• Predictive Machine Learning<br>• Advanced statistical models<br>• Macro trend analysis<br>• Monte Carlo scenarios<br>• Multi-horizon forecasts",
            sugg: ["Create a model", "Define scenarios", "Set up alerts", "Optimize accuracy"]
          }
        ]
      },
      automation: {
        keywords: ["automation", "automate", "robot", "process", "workflow", "automatic"],
        responses: [
          {
            text: "⚙️ <b>Intelligent Automation</b><br><br>Automatable processes:<br>• Bank reconciliations<br>• Invoicing & collections<br>• Quality controls<br>• Automated reporting<br>• Predictive alerts",
            sugg: ["Map processes", "Estimate ROI", "Plan implementation", "Train teams"]
          }
        ]
      },
      strategy: {
        keywords: ["strategy", "strategic", "plan", "development", "growth", "planning"],
        responses: [
          {
            text: "🎯 <b>Financial Strategy</b><br><br>Strategic support:<br>• Financial modeling<br>• Funding plan<br>• Tax optimization<br>• Investment strategy<br>• Risk management",
            sugg: ["Model growth", "Optimize structure", "Assess risks", "Plan investments"]
          }
        ]
      },
      reporting: {
        keywords: ["report", "reporting", "dashboard", "kpi", "metrics", "visualization"],
        responses: [
          {
            text: "📋 <b>Dynamic Reporting</b><br><br>Reporting solutions:<br>• Interactive dashboards<br>• Automated reports<br>• Real-time KPIs<br>• Advanced visualizations<br>• Custom alerts",
            sugg: ["Create dashboard", "Define KPIs", "Automate reports", "Customize views"]
          }
        ]
      },
      ai: {
        keywords: ["ai", "artificial intelligence", "machine learning", "ml", "algorithm"],
        responses: [
          {
            text: "🤖 <b>AI-Powered Finance</b><br><br>AI capabilities:<br>• Predictive analytics<br>• Pattern recognition<br>• Anomaly detection<br>• Risk scoring<br>• Automated insights",
            sugg: ["Explore AI models", "Set up predictions", "Detect anomalies", "Train algorithms"]
          }
        ]
      }
    };

    function addMessage(content, type, suggestions = [], showChart = false) {
      const div = document.createElement('div');
      div.className = `message ${type}`;
      
      // Avatar
      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.textContent = type === 'bot' ? '🤖' : '👤';
      
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.innerHTML = content;
      
      if (type === 'bot') {
        div.appendChild(avatar);
        div.appendChild(bubble);
      } else {
        div.appendChild(bubble);
        div.appendChild(avatar);
      }

      // Add mini chart for certain responses
      if (showChart) {
        const chartContainer = document.createElement('div');
        chartContainer.className = 'chart-container';
        chartContainer.innerHTML = `
          <div class="mini-chart">
            📊 Interactive chart available
          </div>
        `;
        bubble.appendChild(chartContainer);
      }

      // Enhanced suggestions
      if (type === 'bot' && suggestions.length) {
        const suggDiv = document.createElement('div');
        suggDiv.className = 'suggestions';
        suggestions.forEach(text => {
          const btn = document.createElement('button');
          btn.textContent = text;
          btn.onclick = () => {
            input.value = text;
            sendMessage();
          };
          suggDiv.appendChild(btn);
        });
        bubble.appendChild(suggDiv);
      }

      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
      
      // Save to history
      messageHistory.push({
        content: content.replace(/<[^>]*>/g, ''),
        type: type,
        timestamp: new Date()
      });
    }

    function showTyping() {
      const div = document.createElement('div');
      div.className = 'message bot typing-indicator';
      div.innerHTML = `
        <div class="avatar">🤖</div>
        <div class="bubble">
          <div class="typing">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
        </div>
      `;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
      return div;
    }

    function removeTyping(element) {
      if (element && element.parentNode) {
        element.parentNode.removeChild(element);
      }
    }

    function findBestResponse(message) {
      const lower = message.toLowerCase();
      
      // Search in knowledge base
      for (const category in knowledgeBase) {
        const categoryData = knowledgeBase[category];
        for (const keyword of categoryData.keywords) {
          if (lower.includes(keyword)) {
            const responses = categoryData.responses;
            return responses[Math.floor(Math.random() * responses.length)];
          }
        }
      }
      
      // Contextual responses based on history
      if (messageHistory.length > 0) {
        const lastMessage = messageHistory[messageHistory.length - 1];
        if (lastMessage.type === 'bot' && (lower.includes("how") || lower.includes("explain"))) {
          return {
            text: "💡 <b>Personalized Assistance</b><br><br>I can guide you step by step:<br>• Define your objectives<br>• Identify necessary tools<br>• Plan implementation<br>• Track results",
            sugg: ["Start analysis", "See examples", "Plan together", "Get more info"]
          };
        }
      }
      
      // Special responses for specific keywords
      if (lower.includes("thank") || lower.includes("perfect") || lower.includes("great")) {
        return {
          text: "😊 <b>You're welcome!</b><br><br>Feel free to ask if you have other questions. I'm here to optimize your financial processes!",
          sugg: ["New analysis", "Explore other functions", "Get help"]
        };
      }
      
      if (lower.includes("price") || lower.includes("cost") || lower.includes("pricing")) {
        return {
          text: "💰 <b>Tailored Solutions</b><br><br>Our services adapt to your budget:<br>• Free version: basic analysis<br>• Pro: advanced automation<br>• Enterprise: complete solution<br>• Custom: specific development",
          sugg: ["Compare versions", "Request quote", "Try for free", "Schedule demo"]
        };
      }
      
      if (lower.includes("help") || lower.includes("support")) {
        return {
          text: "🆘 <b>HelveticBot Pro Help</b><br><br><b>Special commands:</b><br>• /clear - Clear conversation<br>• /export - Export history<br>• /help - Show this help<br><br><b>Features:</b><br>• Type your questions naturally<br>• Use suggestions to explore<br>• Mention your specific needs<br>• Ask for concrete examples",
          sugg: ["See examples", "Test analysis", "Explore automation"]
        };
      }
      
      // Default enhanced response
      return {
        text: "🤖 <b>HelveticBot Pro at your service!</b><br><br>Finance & Technology expertise:<br>• Advanced financial analysis<br>• Intelligent forecasting<br>• Process automation<br>• Strategy & optimization<br>• Dynamic reporting",
        sugg: ["🔍 Start analysis", "📊 Create forecasts", "⚙️ Automate", "🎯 Define strategy"],
        showChart: true
      };
    }

    function sendMessage() {
      const text = input.value.trim();
      if (!text || isTyping) return;
      
      // Check special commands
      if (handleSpecialCommands(text)) {
        input.value = '';
        return;
      }
      
      sendBtn.disabled = true;
      isTyping = true;
      
      addMessage(text, 'user');
      input.value = '';
      
      const typingIndicator = showTyping();
      
      // Variable response time based on complexity
      const complexity = text.length > 50 ? 2000 : 1200;
      const randomDelay = Math.random() * 600;
      
      setTimeout(() => {
        removeTyping(typingIndicator);
        const response = findBestResponse(text);
        addMessage(response.text, 'bot', response.sugg || [], response.showChart || false);
        
        sendBtn.disabled = false;
        isTyping = false;
      }, complexity + randomDelay);
    }

    function handleSpecialCommands(text) {
      const lower = text.toLowerCase();
      
      if (lower === '/clear' || lower === '/reset') {
        clearChat();
        return true;
      }
      
      if (lower === '/export') {
        exportChat();
        addMessage("💾 <b>Export successful!</b><br>Your conversation has been exported.", "bot");
        return true;
      }
      
      if (lower === '/help') {
        addMessage(`🆘 <b>HelveticBot Pro Help</b><br><br>
        <b>Special commands:</b><br>
        • /clear - Clear conversation<br>
        • /export - Export history<br>
        • /help - Show this help<br><br>
        
        <b>Features:</b><br>
        • Type your questions naturally<br>
        • Use suggestions to explore<br>
        • Mention your specific needs<br>
        • Ask for concrete examples`, "bot", [
          "See examples",
          "Test analysis",
          "Explore automation"
        ]);
        return true;
      }
      
      return false;
    }

    function clearChat() {
      chat.innerHTML = '';
      messageHistory = [];
      showWelcomeMessage();
    }
    
    function exportChat() {
      const chatData = {
        messages: messageHistory,
        timestamp: new Date(),
        version: "HelveticBot Pro v2.1"
      };
      const blob = new Blob([JSON.stringify(chatData, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `helveticbot-chat-${new Date().toISOString().slice(0,10)}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function toggleMinimize() {
      isMinimized = !isMinimized;
      if (isMinimized) {
        chatbotContainer.classList.add('minimized');
      } else {
        chatbotContainer.classList.remove('minimized');
      }
    }

    function closeChatbot() {
      isClosed = true;
      chatbotContainer.classList.add('closed');
      chatToggle.classList.add('show');
    }

    function openChatbot() {
      isClosed = false;
      isMinimized = false;
      chatbotContainer.classList.remove('closed', 'minimized');
      chatToggle.classList.remove('show');
      input.focus();
    }

    function showWelcomeMessage() {
      const welcomeMsg = `🚀 <b>Welcome to HelveticBot Pro!</b><br><br>
      Your next-generation AI financial assistant 🇨🇭<br><br>
      
      <div class="feature-pills">
        <span class="pill">🔮 Predictive AI</span>
        <span class="pill">⚡ Real-time</span>
        <span class="pill">🛡️ Secure</span>
        <span class="pill">🇨🇭 Swiss Made</span>
      </div>
      
      <b>Areas of expertise:</b><br>
      • 📊 Advanced financial analysis<br>
      • 📈 Forecasting & modeling<br>
      • ⚙️ Intelligent automation<br>
      • 🎯 Strategy & optimization<br>
      • 📋 Dynamic reporting<br><br>
      
      <div class="action-buttons">
        <button class="action-btn" onclick="input.value='Perform complete analysis'; sendMessage();">🔍 Quick Analysis</button>
        <button class="action-btn" onclick="input.value='Create forecasts'; sendMessage();">📊 Forecasts</button>
        <button class="action-btn" onclick="input.value='Automate my processes'; sendMessage();">⚙️ Automation</button>
      </div>`;
      
      addMessage(welcomeMsg, "bot", [
        "🚀 Start analysis",
        "📊 Create dashboard", 
        "💡 Optimize strategy",
        "🔧 Configure automation"
      ]);
    }

    // Event listeners
    sendBtn.addEventListener('click', sendMessage);
    
    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
    
    // Auto-resize textarea
    input.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 100) + 'px';
    });

    // Click outside to minimize (optional)
    document.addEventListener('click', (e) => {
      if (!chatbotContainer.contains(e.target) && !chatToggle.contains(e.target) && !isClosed && !isMinimized) {
        // Optional: uncomment to minimize when clicking outside
        // toggleMinimize();
      }
    });

    // Prevent body scroll when chatbot is open
    chatbotContainer.addEventListener('wheel', (e) => {
      e.stopPropagation();
    });

    // Auto-focus on input when opening
    input.focus();

    // Welcome message on load
    setTimeout(() => {
      showWelcomeMessage();
    }, 500);

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && !isClosed) {
