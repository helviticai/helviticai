<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HelveticBot - Financial AI Assistant</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Swiss flag animation */
    @keyframes wave {
      0%, 100% { transform: rotate(-5deg); }
      50% { transform: rotate(5deg); }
    }

    /* Custom animations */
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Mountain background */
    .mountain-bg {
      background-image: 
        linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(147, 197, 253, 0.05) 100%),
        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 300"><defs><linearGradient id="mountain1" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:%23f1f5f9;stop-opacity:0.8"/><stop offset="100%" style="stop-color:%23e2e8f0;stop-opacity:0.4"/></linearGradient><linearGradient id="mountain2" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:%23ddd6fe;stop-opacity:0.6"/><stop offset="100%" style="stop-color:%23c7d2fe;stop-opacity:0.3"/></linearGradient></defs><polygon points="0,300 200,100 400,300" fill="url(%23mountain1)"/><polygon points="150,300 350,80 550,300" fill="url(%23mountain2)"/><polygon points="300,300 500,120 700,300" fill="url(%23mountain1)"/><polygon points="450,300 650,90 850,300" fill="url(%23mountain2)"/><polygon points="600,300 800,110 1000,300" fill="url(%23mountain1)"/><polygon points="750,300 950,70 1200,300" fill="url(%23mountain2)"/></svg>');
      background-size: 1200px 300px, cover;
      background-repeat: repeat-x, no-repeat;
      background-position: bottom, bottom;
    }

    /* Swiss mountains logo */
    .mountain-logo {
      width: 48px;
      height: 48px;
      position: relative;
      background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .mountain-logo::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><defs><linearGradient id="peak1" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:%23ffffff;stop-opacity:0.9"/><stop offset="100%" style="stop-color:%23e2e8f0;stop-opacity:0.7"/></linearGradient><linearGradient id="peak2" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:%23f1f5f9;stop-opacity:0.8"/><stop offset="100%" style="stop-color:%23cbd5e1;stop-opacity:0.6"/></linearGradient></defs><polygon points="0,48 12,20 24,48" fill="url(%23peak1)"/><polygon points="8,48 20,15 32,48" fill="url(%23peak2)"/><polygon points="16,48 28,18 40,48" fill="url(%23peak1)"/><polygon points="24,48 36,12 48,48" fill="url(%23peak2)"/></svg>');
      background-size: cover;
      background-position: center;
    }

    .mountain-logo .tech-overlay {
      position: relative;
      z-index: 1;
      color: white;
      font-weight: bold;
      font-size: 10px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .fade-in-up {
      animation: fadeInUp 0.5s ease-out;
    }

    .typing-dots span {
      animation: bounce 1.4s infinite;
    }
    
    .typing-dots span:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dots span:nth-child(3) {
      animation-delay: 0.4s;
    }

    .chat-container {
      height: calc(100vh - 140px);
    }

    .message-content {
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    /* Custom scrollbar */
    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }
    
    .chat-messages::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 3px;
    }
    
    .chat-messages::-webkit-scrollbar-thumb {
      background: #3b82f6;
      border-radius: 3px;
    }

    /* Hover effects */
    .suggestion-btn:hover {
      transform: translateY(-2px);
    }

    .message-bot {
      background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    }

    .message-user {
      background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
    }
  </style>
</head>
<body class="min-h-screen mountain-bg">
  
  <!-- Header -->
  <div class="bg-white shadow-lg border-b border-blue-100">
    <div class="max-w-4xl mx-auto px-4 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-4">
          <div class="relative">
            <div class="mountain-logo">
              <div class="tech-overlay">AI</div>
            </div>
            <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"></div>
          </div>
          <div class="flex items-center space-x-3">
            <div>
              <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent">
                HelveticBot
              </h1>
              <p class="text-sm text-gray-600 flex items-center">
                <span class="w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></span>
                Financial AI Assistant ‚Ä¢ Helvetic AI
              </p>
            </div>
          </div>
        </div>
        
        <div class="flex items-center space-x-2">
          <button id="exportBtn" class="p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors" title="Export conversation">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
          </button>
          <button id="closeBtn" class="p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors" title="Close window">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
          <div class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">
            üá®üá≠ Switzerland
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Container -->
  <div class="flex flex-col chat-container max-w-4xl mx-auto">
    <!-- Messages Area -->
    <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-6 chat-messages">
      <!-- Initial message -->
      <div class="flex justify-start">
        <div class="flex max-w-3xl items-start space-x-3">
          <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl flex items-center justify-center flex-shrink-0">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
          </div>
          <div class="message-bot rounded-2xl p-4 shadow-lg border border-blue-100 mr-3">
            <div class="message-content">Hello! I'm <strong class="text-blue-800">HelveticBot</strong>, your specialized financial AI assistant. üá®üá≠

I can help you with:
‚Ä¢ <strong class="text-blue-800">Financial analysis</strong> and forecasting
‚Ä¢ <strong class="text-blue-800">Budgeting</strong> and planning
‚Ä¢ <strong class="text-blue-800">Process automation</strong>
‚Ä¢ <strong class="text-blue-800">Strategic advisory</strong> services
‚Ä¢ <strong class="text-blue-800">EPM solutions</strong> and reporting

How can I assist you today?</div>
            <div class="mt-4 space-y-2">
              <p class="text-xs text-gray-500 font-medium">Suggestions:</p>
              <div class="flex flex-wrap gap-2">
                <button class="suggestion-btn text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-1 rounded-full border border-blue-200 transition-all hover:shadow-sm" data-suggestion="üìä Analyze my financial data">
                  üìä Analyze my financial data
                </button>
                <button class="suggestion-btn text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-1 rounded-full border border-blue-200 transition-all hover:shadow-sm" data-suggestion="üìà Create budget forecasts">
                  üìà Create budget forecasts
                </button>
                <button class="suggestion-btn text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-1 rounded-full border border-blue-200 transition-all hover:shadow-sm" data-suggestion="‚öôÔ∏è Automate a process">
                  ‚öôÔ∏è Automate a process
                </button>
                <button class="suggestion-btn text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-1 rounded-full border border-blue-200 transition-all hover:shadow-sm" data-suggestion="üéØ Optimize my financial strategy">
                  üéØ Optimize my financial strategy
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Input Area -->
    <div class="border-t border-gray-200 bg-white p-4">
      <div class="flex items-end space-x-3 max-w-3xl mx-auto">
        <div class="flex-1 relative">
          <textarea
            id="userInput"
            placeholder="Ask your financial question to HelveticBot..."
            class="w-full p-4 pr-12 border border-gray-300 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none max-h-32 shadow-sm"
            rows="1"
          ></textarea>
          <div id="charCount" class="absolute right-3 bottom-3 text-xs text-gray-400">
            0/500
          </div>
        </div>
        <button
          id="sendBtn"
          class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white p-3 rounded-2xl disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-xl"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
          </svg>
        </button>
      </div>
      
      <!-- Quick Actions -->
      <div class="flex flex-wrap justify-center gap-2 mt-3 text-xs">
        <span class="text-gray-500">Quick actions:</span>
        <button class="quick-action bg-gray-100 hover:bg-blue-50 text-gray-700 hover:text-blue-700 px-2 py-1 rounded-md transition-colors" data-action="üí° Strategic advice">
          üí° Strategic advice
        </button>
        <button class="quick-action bg-gray-100 hover:bg-blue-50 text-gray-700 hover:text-blue-700 px-2 py-1 rounded-md transition-colors" data-action="üìä Data analysis">
          üìä Data analysis
        </button>
        <button class="quick-action bg-gray-100 hover:bg-blue-50 text-gray-700 hover:text-blue-700 px-2 py-1 rounded-md transition-colors" data-action="‚öôÔ∏è Automation">
          ‚öôÔ∏è Automation
        </button>
        <button class="quick-action bg-gray-100 hover:bg-blue-50 text-gray-700 hover:text-blue-700 px-2 py-1 rounded-md transition-colors" data-action="üìà Forecasting">
          üìà Forecasting
        </button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-3">
    <div class="max-w-4xl mx-auto flex items-center justify-between text-xs">
      <div class="flex items-center space-x-4">
        <span class="flex items-center">
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
          </svg>
          Powered by Helvetic AI
        </span>
        <span class="flex items-center">
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
          </svg>
          Secure data
        </span>
      </div>
      <div class="flex items-center space-x-2">
        <span>üá®üá≠</span>
        <span>Made in Switzerland</span>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    let messages = [];
    let isTyping = false;

    // Response templates
    const financialTemplates = {
      'analysis': {
        response: 'üìä **Complete Financial Analysis**\n\nPerfect! Here\'s a structured approach for your financial analysis:\n\n**1. Data Collection**\n‚Ä¢ Balance sheet and income statement\n‚Ä¢ Cash flow statements\n‚Ä¢ Industry data\n\n**2. Key Indicators**\n‚Ä¢ Profitability ratios (ROE, ROI)\n‚Ä¢ Liquidity ratios\n‚Ä¢ Debt ratios\n\n**3. Industry Benchmarking**\n\n**AI Recommendations**:\n‚úÖ Automated reporting\n‚úÖ Critical threshold alerts\n‚úÖ Historical-based forecasting',
        suggestions: ['üìä Set up dashboard', 'üìà Analyze profitability', '‚ö° Automate reporting', 'üí° Optimization tips']
      },
      'forecasting': {
        response: 'üìà **Intelligent Budget Forecasting**\n\nExcellent initiative! Here\'s our forecasting methodology:\n\n**üß† Algorithms used**\n‚Ä¢ Predictive Machine Learning\n‚Ä¢ Advanced time series\n‚Ä¢ Correlation analysis\n\n**üìä Integrated data**\n‚Ä¢ Financial history\n‚Ä¢ Macroeconomic data\n‚Ä¢ Industry indicators\n‚Ä¢ Seasonality patterns\n\n**üéØ Deliverables**\n‚Ä¢ Multi-scenario forecasts\n‚Ä¢ Confidence intervals\n‚Ä¢ Influence factors\n‚Ä¢ Interactive dashboard\n\n**Average accuracy: 95%** over 12 months',
        suggestions: ['üéØ Create scenarios', 'üìä Integrate external variables', '‚ö†Ô∏è Set up alerts', 'üìà Optimize accuracy']
      },
      'automation': {
        response: '‚öôÔ∏è **Process Automation**\n\nLet\'s transform your processes together! üöÄ\n\n**üîÑ Automatable processes**\n‚Ä¢ Bank reconciliations\n‚Ä¢ Billing and collections\n‚Ä¢ Consistency checks\n‚Ä¢ Financial consolidation\n\n**üéØ Expected benefits**\n‚Ä¢ **80%** reduction in manual time\n‚Ä¢ **99.5%** accuracy\n‚Ä¢ Complete traceability\n‚Ä¢ Real-time alerts\n\n**üõ†Ô∏è Technologies**\n‚Ä¢ Intelligent RPA\n‚Ä¢ Advanced OCR\n‚Ä¢ Adaptive workflows\n‚Ä¢ Robust APIs\n\n**Average ROI: 300%** in first year',
        suggestions: ['üîÑ Identify other processes', 'üìã Plan implementation', 'üéì Train teams', 'üìä Measure ROI']
      },
      'strategy': {
        response: 'üéØ **Strategic Optimization**\n\nLet\'s develop your optimal financial strategy! üí°\n\n**üìã Strategic diagnosis**\n‚Ä¢ Performance analysis\n‚Ä¢ Lever identification\n‚Ä¢ Competitive benchmarking\n‚Ä¢ Risk/opportunity matrix\n\n**üéØ Action plan**\n‚Ä¢ Working capital optimization\n‚Ä¢ Financial structure\n‚Ä¢ Investment policy\n‚Ä¢ Risk management\n\n**üìä Management tools**\n‚Ä¢ Dynamic dashboards\n‚Ä¢ Custom KPIs\n‚Ä¢ Predictive alerts\n‚Ä¢ Automated reporting\n\n**üá®üá≠ Helvetic AI Approach**\nPrecision, reliability and innovation at the service of your ambitions.',
        suggestions: ['üéØ Define SMART objectives', 'üìä Create monitoring plan', '‚ö° Prioritize actions', 'üîç Analyze competition']
      },
      'epm': {
        response: 'üóÉÔ∏è **Helvetic AI EPM Solutions**\n\nOur EPM platforms integrate:\n\n**üìä Core modules**\n‚Ä¢ Planning & budgeting\n‚Ä¢ Financial consolidation\n‚Ä¢ Regulatory reporting\n‚Ä¢ Performance management\n\n**üîó Native integrations**\n‚Ä¢ ERP systems (SAP, Oracle, etc.)\n‚Ä¢ Accounting systems\n‚Ä¢ Databases\n‚Ä¢ BI tools\n\n**üá®üá≠ Helvetic advantages**\n‚Ä¢ Custom configuration\n‚Ä¢ Banking-grade security\n‚Ä¢ 24/7 support\n‚Ä¢ Continuous training\n\n**Average deployment: 3 months**',
        suggestions: ['üîß Customize solution', 'üìã Plan implementation', 'üéì Organize training', 'üìû Request demo']
      },
      'risk': {
        response: 'üõ°Ô∏è **Risk Management & Compliance**\n\n**üîç Proactive detection**\n‚Ä¢ Anomaly detection algorithms\n‚Ä¢ Real-time monitoring\n‚Ä¢ Automatic alerts\n‚Ä¢ Dynamic risk scoring\n\n**üìã Regulatory compliance**\n‚Ä¢ GDPR & data protection\n‚Ä¢ Accounting standards (IFRS, Swiss GAAP)\n‚Ä¢ Banking regulations\n‚Ä¢ Complete audit trails\n\n**‚ö° Rapid response**\n‚Ä¢ Automatic mitigation plans\n‚Ä¢ Intelligent escalation\n‚Ä¢ Regulatory reporting\n‚Ä¢ Automatic documentation\n\n**üá®üá≠ Swiss standards** for security and reliability',
        suggestions: ['üîí Strengthen security', 'üìä Compliance audit', '‚ö†Ô∏è Configure alerts', 'üìã Continuity plan']
      }
    };

    // DOM elements
    const chatMessages = document.getElementById('chatMessages');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const exportBtn = document.getElementById('exportBtn');
    const closeBtn = document.getElementById('closeBtn');
    const charCount = document.getElementById('charCount');

    // Function to scroll to bottom
    function scrollToBottom() {
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Function to format text with bold
    function formatText(text) {
      return text.replace(/\*\*(.*?)\*\*/g, '<strong class="text-blue-800">$1</strong>');
    }

    // Function to add a message
    function addMessage(type, content, suggestions = []) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `flex ${type === 'user' ? 'justify-end' : 'justify-start'} fade-in-up`;
      
      const isUser = type === 'user';
      const avatarSvg = isUser 
        ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>'
        : '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>';

      messageDiv.innerHTML = `
        <div class="flex max-w-3xl ${isUser ? 'flex-row-reverse' : 'flex-row'} items-start space-x-3">
          <div class="w-10 h-10 ${isUser ? 'bg-gradient-to-br from-gray-600 to-gray-800' : 'bg-gradient-to-br from-blue-600 to-blue-800'} rounded-xl flex items-center justify-center flex-shrink-0">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              ${avatarSvg}
            </svg>
          </div>
          <div class="${isUser ? 'message-user ml-3' : 'message-bot mr-3'} rounded-2xl p-4 shadow-lg ${isUser ? 'text-white' : 'border border-blue-100'}">
            <div class="message-content">${formatText(content)}</div>
            ${!isUser && suggestions.length > 0 ? `
              <div class="mt-4 space-y-2">
                <p class="text-xs text-gray-500 font-medium">Suggestions:</p>
                <div class="flex flex-wrap gap-2">
                  ${suggestions.map(s => `
                    <button class="suggestion-btn text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-1 rounded-full border border-blue-200 transition-all hover:shadow-sm" data-suggestion="${s}">
                      ${s}
                    </button>
                  `).join('')}
                </div>
              </div>
            ` : ''}
          </div>
        </div>
      `;
      
      chatMessages.appendChild(messageDiv);
      
      // Add event listeners for suggestions
      if (!isUser && suggestions.length > 0) {
        messageDiv.querySelectorAll('.suggestion-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            userInput.value = btn.dataset.suggestion;
            userInput.focus();
          });
        });
      }
      
      scrollToBottom();
      
      // Store message
      messages.push({ type, content, timestamp: Date.now() });
    }

    // Function to show typing indicator
    function showTypingIndicator() {
      const typingDiv = document.createElement('div');
      typingDiv.id = 'typing-indicator';
      typingDiv.className = 'flex justify-start fade-in-up';
      typingDiv.innerHTML = `
        <div class="flex items-start space-x-3">
          <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
          </div>
          <div class="message-bot rounded-2xl p-4 shadow-lg border border-blue-100">
            <div class="typing-dots flex space-x-1">
              <span class="w-2 h-2 bg-blue-600 rounded-full"></span>
              <span class="w-2 h-2 bg-blue-600 rounded-full"></span>
              <span class="w-2 h-2 bg-blue-600 rounded-full"></span>
            </div>
            <p class="text-xs text-gray-500 mt-2">HelveticBot is analyzing your request...</p>
          </div>
        </div>
      `;
      chatMessages.appendChild(typingDiv);
      scrollToBottom();
    }

    // Function to hide typing indicator
    function hideTypingIndicator() {
      const typingIndicator = document.getElementById('typing-indicator');
      if (typingIndicator) {
        typingIndicator.remove();
      }
    }

    // Function to generate bot response
    async function generateBotResponse(userMessage) {
      isTyping = true;
      sendBtn.disabled = true;
      showTypingIndicator();
      
      // Simulate processing delay
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      hideTypingIndicator();
      
      const lowerMessage = userMessage.toLowerCase();
      let response = '';
      let suggestions = [];

      // Intent detection based on keywords
      if (lowerMessage.includes('analys') || lowerMessage.includes('data') || lowerMessage.includes('kpi')) {
        response = financialTemplates.analysis.response;
        suggestions = financialTemplates.analysis.suggestions;
      } else if (lowerMessage.includes('forecast') || lowerMessage.includes('budget') || lowerMessage.includes('plan')) {
        response = financialTemplates.forecasting.response;
        suggestions = financialTemplates.forecasting.suggestions;
      } else if (lowerMessage.includes('automat') || lowerMessage.includes('process') || lowerMessage.includes('workflow')) {
        response = financialTemplates.automation.response;
        suggestions = financialTemplates.automation.suggestions;
      } else if (lowerMessage.includes('strateg') || lowerMessage.includes('optim') || lowerMessage.includes('perform')) {
        response = financialTemplates.strategy.response;
        suggestions = financialTemplates.strategy.suggestions;
      } else if (lowerMessage.includes('epm') || lowerMessage.includes('reporting') || lowerMessage.includes('consolidation')) {
        response = financialTemplates.epm.response;
        suggestions = financialTemplates.epm.suggestions;
      } else if (lowerMessage.includes('risk') || lowerMessage.includes('compliance') || lowerMessage.includes('regulatory')) {
        response = financialTemplates.risk.response;
        suggestions = financialTemplates.risk.suggestions;
      } else {
        // Generic response
        response = `ü§ñ **HelveticBot at your service!**\n\nI understand your question about "${userMessage}". \n\n**üá®üá≠ My Helvetic AI expertise covers:**\n\n‚Ä¢ **Financial Intelligence** - Advanced analytics and predictions\n‚Ä¢ **Automation** - Optimized processes and intelligent workflows  \n‚Ä¢ **EPM Solutions** - Planning and performance management\n‚Ä¢ **Risk Management** - Proactive detection and compliance\n‚Ä¢ **Digital Strategy** - Transformation and innovation\n\n**üí° Would you like me to help you with a specific area?**\n\n*Helvetic AI - Swiss precision, global innovation* ‚ö°`;
        suggestions = ['üìä Discover our analytics', '‚öôÔ∏è Explore automation', 'üéØ Optimize my strategy', 'üìû Contact our experts'];
      }

      addMessage('bot', response, suggestions);
      
      isTyping = false;
      sendBtn.disabled = false;
    }

    // Function to send message
    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message || isTyping) return;

      addMessage('user', message);
      userInput.value = '';
      updateCharCount();
      
      await generateBotResponse(message);
    }

    // Function to update character count
    function updateCharCount() {
      const length = userInput.value.length;
      charCount.textContent = `${length}/500`;
      charCount.className = `absolute right-3 bottom-3 text-xs ${length > 450 ? 'text-red-500' : 'text-gray-400'}`;
    }

    // Function to export conversation
    function exportConversation() {
      const timestamp = new Date().toLocaleString();
      let exportText = `HelveticBot Conversation Export\nDate: ${timestamp}\n${'='.repeat(50)}\n\n`;
      
      messages.forEach((msg, index) => {
        const sender = msg.type === 'user' ? 'You' : 'HelveticBot';
        const time = new Date(msg.timestamp).toLocaleTimeString();
        exportText += `[${time}] ${sender}:\n${msg.content.replace(/<[^>]*>/g, '')}\n\n`;
      });
      
      const blob = new Blob([exportText], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `helveticbot-conversation-${Date.now()}.txt`;
      a.click();
      URL.revokeObjectURL(url);
    }

    // Function to close window
    function closeWindow() {
      if (confirm('Are you sure you want to close HelveticBot? Your conversation will be lost unless exported.')) {
        // Try different methods to close the window
        if (window.opener) {
          window.close();
        } else {
          // If we can't close, redirect to a blank page or hide content
          document.body.innerHTML = `
            <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100">
              <div class="text-center">
                <div class="swiss-flag mx-auto mb-4"></div>
                <h1 class="text-2xl font-bold text-gray-800 mb-2">HelveticBot Session Closed</h1>
                <p class="text-gray-600 mb-4">Thank you for using HelveticBot!</p>
                <button onclick="location.reload()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                  Restart HelveticBot
                </button>
              </div>
            </div>
          `;
        }
      }
    }

    // Event listeners
    sendBtn.addEventListener('click', sendMessage);
    exportBtn.addEventListener('click', exportConversation);
    closeBtn.addEventListener('click', closeWindow);

    userInput.addEventListener('input', updateCharCount);
    userInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    // Auto-resize textarea
    userInput.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 128) + 'px';
    });

    // Quick action buttons
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('quick-action')) {
        userInput.value = e.target.dataset.action;
        userInput.focus();
      }
    });

    // Suggestion buttons (for dynamically added ones)
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('suggestion-btn')) {
        userInput.value = e.target.dataset.suggestion;
        userInput.focus();
      }
    });

    // Initialize
    updateCharCount();
  </script>
</body>
</html>
