<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Helvetic AI Chatbot</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    .chat-background {
      background: url("https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1600&q=80") no-repeat center center;
      background-size: cover;
      position: relative;
    }
    .chat-background::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(255, 255, 255, 0.45); /* ðŸ‘ˆ voile lÃ©ger pour voir les montagnes */
      backdrop-filter: blur(2px);
      z-index: 0;
    }
    #chatbot-messages > div {
      position: relative;
      z-index: 1;
    }
    .message-bubble-bot {
      background: #ffffff;
      color: #1f2937;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      border-radius: 1rem;
    }
    .message-bubble-user {
      background: #dc2626; /* rouge suisse */
      color: #ffffff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      border-radius: 1rem;
    }
    .line-clamp-5 {
      display: -webkit-box;
      -webkit-line-clamp: 5;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="chatbot-window" class="w-full h-screen flex flex-col relative overflow-hidden chat-background">
    <!-- Header -->
    <div class="bg-red-600 text-white flex justify-between items-center p-4 shadow-lg relative z-10">
      <div class="flex items-center space-x-2">
        <!-- ðŸ‡¨ðŸ‡­ Drapeau officiel (ton fichier Switzerland.svg) -->
        <img src="Switzerland.svg" alt="Drapeau Suisse" class="w-7 h-7 rounded-sm shadow-md" />
        <span class="font-bold text-lg">Helvetic AI</span>
      </div>
      <select id="lang-select" class="text-gray-800 rounded-lg px-2 py-1 text-sm">
        <option value="fr">FR</option>
        <option value="en">EN</option>
        <option value="de">DE</option>
      </select>
    </div>

    <!-- Messages -->
    <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 space-y-3"></div>

    <!-- Quick Questions -->
    <div class="border-t border-gray-200 bg-white/80 backdrop-blur-sm p-4 relative z-10">
      <div id="questions-container" class="space-y-2"></div>
      <button id="toggle-questions" class="mt-3 text-indigo-600 text-sm underline">
        Voir plus
      </button>
    </div>

    <!-- Input -->
    <div class="border-t border-gray-300 bg-white p-3 flex items-center space-x-2 relative z-10">
      <input id="user-input" type="text" placeholder="Posez votre question..."
        class="flex-1 p-2 border rounded-lg text-sm" />
      <button onclick="handleUserInput()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
        Envoyer
      </button>
    </div>
  </div>

  <!-- Import FAQ -->
  <script src="faq.js"></script>
  <script>
    let currentLang = "fr";
    let conversationHistory = [];
    let showAllQuestions = false;

    const introTexts = {
      fr: `âœ¨ Helvetic AI â€“ Lâ€™intelligence artificielle au service de la performance financiÃ¨re âœ¨

Helvetic AI accompagne les directions financiÃ¨res dans leur transformation digitale.
Notre ambition : mettre la puissance de lâ€™intelligence artificielle et de lâ€™Enterprise Performance Management (EPM) au service des dÃ©cideurs.

ðŸ”¹ Une expertise unique : rigueur suisse + approche pragmatique.
ðŸ”¹ Des solutions concrÃ¨tes : automatisation, analyse prÃ©dictive, optimisation budgÃ©taire, pilotage de la performance.
ðŸ”¹ Un engagement fort : fiabilitÃ©, innovation maÃ®trisÃ©e, conformitÃ© rÃ©glementaire.

ðŸ‘‰ Avec Helvetic AI, la performance financiÃ¨re devient plus intelligente, plus rapide et plus sÃ»re.`,
      en: `âœ¨ Helvetic AI â€“ Artificial Intelligence at the service of financial performance âœ¨

Helvetic AI supports CFOs in their digital transformation.
Our ambition: leverage AI and Enterprise Performance Management (EPM) to turn data into a strategic lever.

ðŸ”¹ Unique expertise: Swiss precision + pragmatic, results-driven approach.
ðŸ”¹ Concrete solutions: automation, predictive analysis, budgeting optimization, performance management.
ðŸ”¹ Strong commitment: reliability, controlled innovation, compliance.

ðŸ‘‰ With Helvetic AI, financial performance becomes smarter, faster, safer.`,
      de: `âœ¨ Helvetic AI â€“ KÃ¼nstliche Intelligenz im Dienste der Finanzperformance âœ¨

Helvetic AI begleitet Finanzdirektionen bei der digitalen Transformation.
Unsere Mission: die LeistungsfÃ¤higkeit von KI und Enterprise Performance Management (EPM) als strategischen Hebel einsetzen.

ðŸ”¹ Einzigartige Expertise: Schweizer PrÃ¤zision + pragmatischer Ansatz.
ðŸ”¹ Konkrete LÃ¶sungen: Automatisierung, prÃ¤diktive Analysen, Budgetoptimierung, Performance-Steuerung.
ðŸ”¹ Starkes Engagement: ZuverlÃ¤ssigkeit, kontrollierte Innovation, Compliance.

ðŸ‘‰ Mit Helvetic AI wird Finanzperformance intelligenter, schneller und sicherer.`
    };

    function addMessage(text, sender = "bot", collapsible = false) {
      const wrapper = document.createElement("div");
      wrapper.className = sender === "user" ? "text-right" : "text-left";

      const bubble = document.createElement("div");
      bubble.className =
        sender === "user"
          ? "inline-block px-4 py-3 max-w-xs lg:max-w-md text-sm font-medium message-bubble-user"
          : "inline-block px-4 py-3 max-w-xs lg:max-w-md text-sm font-medium message-bubble-bot whitespace-pre-line";

      if (collapsible) {
        bubble.innerHTML = `
          <div class="line-clamp-5" id="msg-${conversationHistory.length}">
            ${text}
          </div>
          <button class="mt-2 text-indigo-600 text-xs underline toggle-btn">
            ${currentLang === "fr" ? "Lire plus" : currentLang === "en" ? "Read more" : "Mehr lesen"}
          </button>
        `;
      } else {
        bubble.textContent = text;
      }

      wrapper.appendChild(bubble);
      document.getElementById("chatbot-messages").appendChild(wrapper);
      document.getElementById("chatbot-messages").scrollTop =
        document.getElementById("chatbot-messages").scrollHeight;

      conversationHistory.push({ sender, text, time: new Date().toISOString() });

      if (collapsible) {
        const btn = bubble.querySelector(".toggle-btn");
        const content = bubble.querySelector(`#msg-${conversationHistory.length - 1}`);
        btn.addEventListener("click", () => {
          if (content.classList.contains("line-clamp-5")) {
            content.classList.remove("line-clamp-5");
            btn.textContent = currentLang === "fr" ? "Lire moins" : currentLang === "en" ? "Read less" : "Weniger lesen";
          } else {
            content.classList.add("line-clamp-5");
            btn.textContent = currentLang === "fr" ? "Lire plus" : currentLang === "en" ? "Read more" : "Mehr lesen";
          }
        });
      }
    }

    function getAnswer(userInput) {
      const db = faq[currentLang];
      const query = userInput.toLowerCase();
      for (const key in db) {
        const keywords = key.split(" ");
        if (keywords.some(word => query.includes(word))) {
          return db[key];
        }
      }
      return currentLang === "fr"
        ? "DÃ©solÃ©, je nâ€™ai pas encore de rÃ©ponse pour Ã§a."
        : currentLang === "en"
        ? "Sorry, I donâ€™t have an answer for that yet."
        : "Entschuldigung, ich habe dafÃ¼r noch keine Antwort.";
    }

    function handleUserInput() {
      const input = document.getElementById("user-input");
      const question = input.value.trim();
      if (!question) return;

      addMessage(question, "user");
      input.value = "";

      setTimeout(() => {
        const answer = getAnswer(question);
        addMessage(answer, "bot", answer.length > 150);
      }, 600);
    }

    function updateQuickQuestions() {
      const container = document.getElementById("questions-container");
      container.innerHTML = "";

      const questions = quickQuestions[currentLang];
      const limit = showAllQuestions ? questions.length : 3;

      questions.slice(0, limit).forEach(q => {
        const btn = document.createElement("button");
        btn.className =
          "w-full text-left p-2 rounded-lg text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200";
        btn.textContent = q;
        btn.onclick = () => {
          addMessage(q, "user");
          setTimeout(() => addMessage(getAnswer(q), "bot"), 600);
        };
        container.appendChild(btn);
      });

      document.getElementById("toggle-questions").textContent =
        showAllQuestions
          ? currentLang === "fr" ? "Voir moins" : currentLang === "en" ? "See less" : "Weniger sehen"
          : currentLang === "fr" ? "Voir plus" : currentLang === "en" ? "See more" : "Mehr sehen";
    }

    document.addEventListener("DOMContentLoaded", () => {
      addMessage(introTexts[currentLang], "bot", true);
      updateQuickQuestions();
    });

    document.getElementById("lang-select").addEventListener("change", e => {
      currentLang = e.target.value;
      document.getElementById("chatbot-messages").innerHTML = "";
      conversationHistory = [];
      addMessage(introTexts[currentLang], "bot", true);
      updateQuickQuestions();
    });

    document.getElementById("toggle-questions").addEventListener("click", () => {
      showAllQuestions = !showAllQuestions;
      updateQuickQuestions();
    });
  </script>
</body>
</html>
