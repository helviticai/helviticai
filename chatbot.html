<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Helvetic AI Chatbot</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .dropdown {position: relative; display: inline-block;}
    .dropdown-content {display: none; position: absolute; right: 0; background: #fff; min-width: 140px; box-shadow: 0 4px 10px rgba(0,0,0,.1); border-radius: 6px; z-index: 100;}
    .dropdown-content button {width: 100%; text-align: left; padding: 8px 12px; border: none; background: none; cursor: pointer; font-size: .875rem;}
    .dropdown-content button:hover {background: #f3f4f6;}
    .dropdown.show .dropdown-content {display: block;}
    .line-clamp-5 {-webkit-line-clamp: 5; -webkit-box-orient: vertical; display: -webkit-box; overflow: hidden;}
    .suggestion-chip, .question-chip {
      opacity: 0;
      transform: translateY(8px);
      transition: all 0.4s ease;
    }
    .suggestion-chip.show, .question-chip.show {
      opacity: 1;
      transform: translateY(0);
    }
    .suggestion-chip:hover, .question-chip:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(99,102,241,0.2);
    }
    .suggestion-chip:active, .question-chip:active {transform: scale(0.95);}
  </style>
</head>
<body class="bg-gray-50">
<div id="chatbot-window" class="w-full h-screen flex flex-col relative overflow-hidden border border-gray-200 shadow-xl rounded-lg">
  
  <!-- Header -->
  <div class="bg-indigo-600 text-white flex justify-between items-center p-4 shadow relative z-10">
    <div class="flex items-center space-x-3">
      <div class="w-10 h-10 rounded-full flex items-center justify-center overflow-hidden bg-white">
        <svg width="24" height="24" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><rect width="32" height="32" fill="#FF0000" rx="4"/><rect x="6" y="13" width="20" height="6" fill="#FFF" rx="1"/><rect x="13" y="6" width="6" height="20" fill="#FFF" rx="1"/></svg>
      </div>
      <div>
        <span class="font-bold text-base sm:text-lg">Helvetic AI</span>
        <div class="text-xs opacity-90" id="status-indicator">En ligne</div>
      </div>
    </div>
    <div class="flex items-center space-x-2">
      <div class="dropdown" id="exportDropdown">
        <button onclick="toggleDropdown()" class="px-3 py-1 bg-white/20 rounded text-sm">ðŸ’¾ Exporter</button>
        <div class="dropdown-content">
          <button onclick="exportConversation('txt')">ðŸ“„ Exporter en TXT</button>
          <button onclick="exportConversation('json')">ðŸ“‚ Exporter en JSON</button>
        </div>
      </div>
      <select id="lang-select" class="text-gray-800 rounded-lg px-2 py-1 text-xs font-medium focus:outline-none focus:ring-2 focus:ring-white/50">
        <option value="fr">ðŸ‡«ðŸ‡· FR</option>
        <option value="en">ðŸ‡¬ðŸ‡§ EN</option>
        <option value="de">ðŸ‡©ðŸ‡ª DE</option>
      </select>
      <button onclick="parent.closeChatbot()" class="w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold">Ã—</button>
    </div>
  </div>

  <!-- Messages -->
  <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 space-y-4 bg-white"></div>

  <!-- Quick Questions -->
  <div class="border-t border-gray-200 bg-gray-50 p-4">
    <div class="text-xs sm:text-sm font-semibold text-gray-700 mb-3 flex items-center" id="questions-title">
      <svg class="w-4 h-4 mr-2 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
      Questions rapides :
    </div>
    <div id="questions-container" class="flex flex-wrap gap-2"></div>
  </div>

  <!-- Input -->
  <div class="border-t border-gray-300 bg-white p-3 flex items-center space-x-2">
    <input id="user-input" type="text" placeholder="Posez votre question..." class="flex-1 p-2 border rounded-lg text-sm"/>
    <button onclick="handleUserInput()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">Envoyer</button>
  </div>
</div>

<script>
const quickQuestions = {
  fr:["Qu'est-ce que l'IA en finance ?","Quels sont vos services ?","Quels sont les avantages de lâ€™EPM ?","Combien coÃ»te une implÃ©mentation IA ?","Puis-je demander une dÃ©mo ?"],
  en:["What is AI in finance?","What services do you offer?","What are the benefits of EPM?","How much does AI implementation cost?","Can I request a demo?"],
  de:["Was ist KI im Finanzwesen?","Welche Dienstleistungen bieten Sie an?","Was sind die Vorteile von EPM?","Wie viel kostet eine KI-Implementierung?","Kann ich eine Demo anfordern?"]
};
const translations = {
  fr:{welcome:`âœ¨ Helvetic AI â€“ Lâ€™intelligence artificielle au service de la performance financiÃ¨re âœ¨

Helvetic AI accompagne les directions financiÃ¨res dans leur transformation digitale.
Notre ambition : mettre la puissance de lâ€™intelligence artificielle et de lâ€™Enterprise Performance Management (EPM) au service des dÃ©cideurs.

ðŸ”¹ Une expertise unique : rigueur suisse + approche pragmatique.
ðŸ”¹ Des solutions concrÃ¨tes : automatisation, analyse prÃ©dictive, optimisation budgÃ©taire.
ðŸ”¹ Un engagement fort : fiabilitÃ©, innovation maÃ®trisÃ©e, conformitÃ© rÃ©glementaire.`,online:"En ligne",readMore:"Lire plus",readLess:"Lire moins",seeMore:"Voir plus",seeLess:"Voir moins"},
  en:{welcome:`âœ¨ Helvetic AI â€“ Artificial Intelligence at the service of financial performance âœ¨

Helvetic AI supports CFOs in their digital transformation, turning data into a real strategic lever through AI and EPM.

ðŸ”¹ Unique expertise: Swiss precision + pragmatic methods.
ðŸ”¹ Concrete solutions: automation, predictive analysis, budgeting optimization.
ðŸ”¹ Strong commitment: reliability, controlled innovation, compliance.`,online:"Online",readMore:"Read more",readLess:"Read less",seeMore:"See more",seeLess:"See less"},
  de:{welcome:`âœ¨ Helvetic AI â€“ KÃ¼nstliche Intelligenz im Dienste der Finanzperformance âœ¨

Helvetic AI begleitet Finanzdirektionen bei der digitalen Transformation und macht Daten dank KI und EPM zu einem echten strategischen Hebel.

ðŸ”¹ Einzigartige Expertise: Schweizer PrÃ¤zision + pragmatische AnsÃ¤tze.
ðŸ”¹ Konkrete LÃ¶sungen: Automatisierung, prÃ¤diktive Analysen, Budgetoptimierung.
ðŸ”¹ Starkes Engagement: ZuverlÃ¤ssigkeit, kontrollierte Innovation, Compliance.`,online:"Online",readMore:"Mehr lesen",readLess:"Weniger lesen",seeMore:"Mehr anzeigen",seeLess:"Weniger anzeigen"}};
const welcomeSuggestions = {
  fr:["Nos services","Avantages de lâ€™IA","Demander une dÃ©mo"],
  en:["Our services","AI benefits","Request a demo"],
  de:["Unsere Dienstleistungen","KI-Vorteile","Demo anfordern"]
};
const responses = {
  fr:{"Qu'est-ce que l'IA en finance ?":"L'IA en finance transforme la gestion financiÃ¨re.","Quels sont vos services ?":"Nous proposons automatisation, optimisation budgÃ©taire et analyse prÃ©dictive.","Quels sont les avantages de lâ€™EPM ?":"Meilleure visibilitÃ©, planification optimisÃ©e, dÃ©cisions fiables.","Combien coÃ»te une implÃ©mentation IA ?":"Ã€ partir de 15 000 CHF selon la complexitÃ©.","Puis-je demander une dÃ©mo ?":"Oui, via notre site web.","Nos services":"Automatisation, analyse prÃ©dictive, pilotage de la performance.","Avantages de lâ€™IA":"Gain de temps, prÃ©cision, meilleure anticipation.","Demander une dÃ©mo":"Vous pouvez demander une dÃ©mo personnalisÃ©e via notre site."},
  en:{"What is AI in finance?":"AI transforms financial management.","What services do you offer?":"Automation, budgeting optimization, predictive analytics.","What are the benefits of EPM?":"Improved visibility, better planning, reliable decisions.","How much does AI implementation cost?":"Starting from CHF 15,000 depending on complexity.","Can I request a demo?":"Yes, on our website.","Our services":"Automation, predictive analytics, performance management.","AI benefits":"Time saving, precision, anticipation.","Request a demo":"You can request a personalized demo via our website."},
  de:{"Was ist KI im Finanzwesen?":"KI transformiert das Finanzmanagement.","Welche Dienstleistungen bieten Sie an?":"Automatisierung, Budgetoptimierung, prÃ¤diktive Analysen.","Was sind die Vorteile von EPM?":"Bessere Transparenz, optimierte Planung, zuverlÃ¤ssigere Entscheidungen.","Wie viel kostet eine KI-Implementierung?":"Ab CHF 15.000 je nach KomplexitÃ¤t.","Kann ich eine Demo anfordern?":"Ja, Ã¼ber unsere Website.","Unsere Dienstleistungen":"Automatisierung, prÃ¤diktive Analysen, Performance-Steuerung.","KI-Vorteile":"Zeitersparnis, Genauigkeit, bessere Planung.","Demo anfordern":"Sie kÃ¶nnen eine personalisierte Demo Ã¼ber unsere Website anfordern."}
};
let currentLang="fr",conversationHistory=[],expanded=false;

function addMessage(text,sender="bot",isWelcome=false){
  const wrapper=document.createElement("div");
  wrapper.className= sender==="user"?"text-right":"text-left";
  const bubble=document.createElement("div");
  bubble.className= sender==="user"?"inline-block px-4 py-2 rounded-2xl max-w-xs text-sm font-medium bg-indigo-600 text-white":"inline-block px-4 py-2 rounded-2xl max-w-xs text-sm font-medium bg-gray-100 text-gray-800 whitespace-pre-line";
  
  if(isWelcome){
    bubble.innerHTML=`
      <div id="welcome-preview" class="line-clamp-5">${text}</div>
      <button id="toggleWelcome" class="mt-2 text-indigo-600 text-xs underline">${translations[currentLang].readMore}</button>
      <div id="welcome-suggestions" class="flex flex-wrap gap-2 mt-3"></div>`;
    setTimeout(()=>{
      const toggle=document.getElementById("toggleWelcome");
      const preview=document.getElementById("welcome-preview");
      toggle.addEventListener("click",()=>{
        if(toggle.textContent===translations[currentLang].readMore){
          preview.classList.remove("line-clamp-5");
          toggle.textContent=translations[currentLang].readLess;
        } else {
          preview.classList.add("line-clamp-5");
          toggle.textContent=translations[currentLang].readMore;
        }
      });
      // suggestions
      const sugContainer=document.getElementById("welcome-suggestions");
      welcomeSuggestions[currentLang].forEach((sug,i)=>{
        const chip=document.createElement("button");
        chip.className="suggestion-chip px-3 py-1 rounded-full text-sm font-medium bg-indigo-50 text-indigo-700 border border-indigo-200 transition-all";
        chip.textContent=sug;
        chip.onclick=()=>{addMessage(sug,"user");setTimeout(()=>{addMessage(responses[currentLang][sug]||"â€¦","bot");},800);};
        sugContainer.appendChild(chip);
        setTimeout(()=>chip.classList.add("show"),i*200);
      });
    },50);
  } else {
    bubble.textContent=text;
  }
  wrapper.appendChild(bubble);
  document.getElementById("chatbot-messages").appendChild(wrapper);
  document.getElementById("chatbot-messages").scrollTop=document.getElementById("chatbot-messages").scrollHeight;
  conversationHistory.push({sender,text,time:new Date().toISOString()});
}

function handleUserInput(){
  const input=document.getElementById("user-input");
  const val=input.value.trim();
  if(!val) return;
  addMessage(val,"user");
  input.value="";
  setTimeout(()=>{
    addMessage(responses[currentLang][val]||"DÃ©solÃ©, je nâ€™ai pas encore de rÃ©ponse pour Ã§a.","bot");
  },800);
}

function updateQuickQuestions(){
  const container=document.getElementById("questions-container");
  container.innerHTML="";
  const all=quickQuestions[currentLang];
  const visible= expanded? all: all.slice(0,3);
  visible.forEach((q,i)=>{
    const chip=document.createElement("button");
    chip.className="question-chip px-3 py-1 rounded-full text-sm font-medium bg-white text-gray-700 border border-gray-300 transition-all";
    chip.textContent=q;
    chip.onclick=()=>{addMessage(q,"user");setTimeout(()=>addMessage(responses[currentLang][q]||"â€¦","bot"),800);};
    container.appendChild(chip);
    setTimeout(()=>chip.classList.add("show"),i*150);
  });
  if(all.length>3){
    const toggle=document.createElement("button");
    toggle.className="w-full text-center py-2 text-indigo-600 text-sm font-semibold";
    toggle.textContent=expanded?translations[currentLang].seeLess:translations[currentLang].seeMore;
    toggle.onclick=()=>{expanded=!expanded;updateQuickQuestions();};
    container.appendChild(toggle);
  }
}

function exportConversation(fmt="txt"){
  if(conversationHistory.length===0) return alert("Aucune conversation Ã  exporter.");
  let data,blob,file;
  if(fmt==="json"){data=JSON.stringify(conversationHistory,null,2);blob=new Blob([data],{type:"application/json"});file="conversation.json";}
  else{data=conversationHistory.map(m=>`[${m.time}] ${m.sender.toUpperCase()}: ${m.text}`).join("\n");blob=new Blob([data],{type:"text/plain"});file="conversation.txt";}
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download=file;a.click();
  document.getElementById("exportDropdown").classList.remove("show");
}
function toggleDropdown(){document.getElementById("exportDropdown").classList.toggle("show");}

// Init
document.addEventListener("DOMContentLoaded",()=>{
  addMessage(translations[currentLang].welcome,"bot",true);
  updateQuickQuestions();
});
document.getElementById("lang-select").addEventListener("change",e=>{
  currentLang=e.target.value;
  document.getElementById("status-indicator").textContent=translations[currentLang].online;
  document.getElementById("chatbot-messages").innerHTML="";
  conversationHistory=[];
  expanded=false;
  addMessage(translations[currentLang].welcome,"bot",true);
  updateQuickQuestions();
});
window.addEventListener("click",e=>{
  if(!e.target.closest("#exportDropdown")) document.getElementById("exportDropdown").classList.remove("show");
});
</script>
</body>
</html>
