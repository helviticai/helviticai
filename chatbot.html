<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helvetic AI Chatbot</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  #questions-container {
  max-height: 200px;   /* limite la hauteur visible */
  overflow-y: auto;    /* active le scroll interne */
  scrollbar-width: thin;
  scrollbar-color: #cbd5e1 #f1f5f9;
}
#questions-container::-webkit-scrollbar {
  width: 6px;
}
#questions-container::-webkit-scrollbar-track {
  background: #f1f5f9;
}
#questions-container::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}

.glass-effect {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}
.gradient-bg {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: #cbd5e1 #f1f5f9;
}
.scrollbar-thin::-webkit-scrollbar {
  width: 6px;
}
.scrollbar-thin::-webkit-scrollbar-track {
  background: #f1f5f9;
}
.scrollbar-thin::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 3px;
}
.typing-indicator {
  display: flex;
  padding: 8px 16px;
  background: #e5e7eb;
  border-radius: 16px;
  width: fit-content;
  margin: 4px 0;
}
.typing-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: #6b7280;
  animation: typing 1.4s infinite;
  margin-right: 4px;
}
.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; margin-right: 0; }
@keyframes typing {
  0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
  30% { transform: translateY(-8px); opacity: 1; }
}
.message-fade-in {
  animation: fadeInUp 0.3s ease-out;
}
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}
.question-btn {
  transition: all 0.2s ease;
  border: 1px solid #e5e7eb;
}
.question-btn:hover {
  border-color: #3b82f6;
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
}
.toggle-btn {
  transition: all 0.2s ease;
}
.toggle-btn:hover {
  transform: scale(1.02);
}
</style>
</head>
<body>

<!-- Fenêtre du chatbot -->
<div id="chatbot-window" class="w-full h-screen glass-effect flex flex-col relative overflow-hidden">
  <!-- Header -->
  <div class="gradient-bg text-white flex justify-between items-center p-4 shadow-lg">
    <div class="flex items-center space-x-3">
      <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center overflow-hidden">
        <svg width="20" height="20" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
          <rect width="32" height="32" fill="#FF0000"/>
          <rect x="6" y="13" width="20" height="6" fill="#FFFFFF"/>
          <rect x="13" y="6" width="6" height="20" fill="#FFFFFF"/>
        </svg>
      </div>
      <div>
        <span class="font-bold">Helvetic AI</span>
        <div class="text-xs opacity-75" id="status-indicator">En ligne</div>
      </div>
    </div>
    <div class="flex items-center space-x-2">
      <div class="relative">
        <select id="lang-select" class="text-black rounded px-8 py-1 text-sm appearance-none bg-white pr-6">
          <option value="fr">Français</option>
          <option value="en">English</option>
          <option value="de">Deutsch</option>
        </select>
      </div>
      <button onclick="parent.closeChatbot()" class="ml-2 text-lg font-bold hover:bg-white/20 w-6 h-6 rounded-full flex items-center justify-center transition-colors">×</button>
    </div>
  </div>

  <!-- Messages -->
  <div id="chatbot-messages" class="flex-1 overflow-y-auto p-4 space-y-3 scrollbar-thin bg-gray-50"></div>

  <!-- Questions rapides -->
  <div class="border-t bg-white p-4">
    <div class="text-sm font-medium text-gray-600 mb-3" id="questions-title">Questions rapides :</div>
    <div id="questions-container" class="space-y-2"></div>
  </div>
</div>

<!-- Scripts -->
<script>
const quickQuestions = {
  fr: [
    "Qu'est-ce que l'IA en finance ?",
    "Quels sont les avantages de l'IA pour l'EPM ?",
    "Comment intégrer l'IA dans mon système ?",
    "Quel est le ROI de l'IA en finance ?",
    "Quelles technologies IA utilisez-vous ?",
    "Combien coûte une implémentation IA ?",
    "L'IA peut-elle améliorer mes prévisions ?",
    "Comment assurer la sécurité des données ?"
  ],
  en: [
    "What is AI in finance?",
    "What are the benefits of AI for EPM?",
    "How to integrate AI in my system?",
    "What is the ROI of AI in finance?",
    "What AI technologies do you use?",
    "How much does AI implementation cost?",
    "Can AI improve my forecasts?",
    "How to ensure data security?"
  ],
  de: [
    "Was ist KI im Finanzwesen?",
    "Was sind die Vorteile von KI für EPM?",
    "Wie integriere ich KI in mein System?",
    "Was ist der ROI von KI im Finanzwesen?",
    "Welche KI-Technologien verwenden Sie?",
    "Wie viel kostet eine KI-Implementierung?",
    "Kann KI meine Prognosen verbessern?",
    "Wie stelle ich Datensicherheit sicher?"
  ]
};

const translations = {
  fr: {
    typing: "En train d'écrire...",
    online: "En ligne",
    questionsTitle: "Questions rapides :",
    seeMore: "Voir plus",
    seeLess: "Voir moins",
    welcome: "Bonjour ! Je suis votre assistant IA Helvetic. Choisissez une question ci-dessous pour commencer."
  },
  en: {
    typing: "Typing...",
    online: "Online",
    questionsTitle: "Quick questions:",
    seeMore: "See more",
    seeLess: "See less",
    welcome: "Hello! I'm your Helvetic AI assistant. Choose a question below to get started."
  },
  de: {
    typing: "Schreibt...",
    online: "Online",
    questionsTitle: "Schnellfragen:",
    seeMore: "Mehr anzeigen",
    seeLess: "Weniger anzeigen",
    welcome: "Hallo! Ich bin Ihr Helvetic AI Assistent. Wählen Sie eine Frage unten aus, um zu beginnen."
  }
};

const messagesContainer = document.getElementById("chatbot-messages");
const questionsContainer = document.getElementById("questions-container");
const questionsTitle = document.getElementById("questions-title");

let currentLang = "fr";
let isTyping = false;
let expanded = false;

function addMessage(text, sender = "bot", animate = true) {
  const msg = document.createElement("div");
  msg.className = `${sender === "user" ? "text-right" : "text-left"} ${animate ? "message-fade-in" : ""}`;
  const bubble = document.createElement("div");
  bubble.className = `inline-block px-4 py-2 rounded-2xl max-w-xs lg:max-w-md ${
    sender === "user" 
      ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white' 
      : 'bg-white text-gray-900 border border-gray-200 shadow-sm'
  }`;
  bubble.style.whiteSpace = "pre-wrap";
  bubble.textContent = text;
  msg.appendChild(bubble);
  messagesContainer.appendChild(msg);
  messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function updateQuickQuestions() {
  questionsContainer.innerHTML = "";
  questionsTitle.textContent = translations[currentLang].questionsTitle;

  const questions = quickQuestions[currentLang];
  const visibleCount = expanded ? questions.length : 3;
  const visibleQuestions = questions.slice(0, visibleCount);

  visibleQuestions.forEach((question) => {
    const button = document.createElement("button");
    button.className = "question-btn w-full text-left p-3 rounded-lg bg-white hover:bg-gray-50 text-sm";
    button.textContent = question;
    button.onclick = () => addMessage("Réponse à : " + question, "bot");
    questionsContainer.appendChild(button);
  });

  if (questions.length > 3) {
    const toggleButton = document.createElement("button");
    toggleButton.className =
      "toggle-btn w-full p-2 text-center text-sm text-blue-600 hover:text-blue-700 font-medium";
    toggleButton.textContent = expanded
      ? translations[currentLang].seeLess
      : translations[currentLang].seeMore;

    toggleButton.addEventListener("click", () => {
      expanded = !expanded;
      updateQuickQuestions();
    });

    questionsContainer.appendChild(toggleButton);
  }
}

document.addEventListener("DOMContentLoaded", () => {
  addMessage(translations[currentLang].welcome, "bot", false);
  updateQuickQuestions();
});
</script>
</body>
</html>
