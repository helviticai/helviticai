<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>HelveticBot Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      height: 100vh;
      position: relative;
    }
    
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      pointer-events: none;
    }
    
    header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      position: relative;
      z-index: 10;
    }
    
    header h1 {
      font-size: 24px;
      background: linear-gradient(45deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 0;
      font-weight: 700;
    }
    
    .status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #666;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      background: #22c55e;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .chat {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }
    
    .message {
      margin-bottom: 20px;
      display: flex;
      align-items: flex-start;
      animation: fadeInUp 0.3s ease-out;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .message.user {
      justify-content: flex-end;
    }
    
    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      margin: 0 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: bold;
    }
    
    .message.bot .avatar {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      order: 0;
    }
    
    .message.user .avatar {
      background: linear-gradient(45deg, #f093fb, #f5576c);
      color: white;
      order: 1;
    }
    
    .bubble {
      padding: 15px 18px;
      border-radius: 20px;
      max-width: 70%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      white-space: pre-wrap;
      position: relative;
      backdrop-filter: blur(10px);
    }
    
    .message.bot .bubble {
      background: rgba(255, 255, 255, 0.95);
      color: #333;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .message.user .bubble {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
    }
    
    .typing {
      display: flex;
      gap: 4px;
      padding: 10px;
    }
    
    .typing-dot {
      width: 6px;
      height: 6px;
      background: #667eea;
      border-radius: 50%;
      animation: typing 1.4s infinite;
    }
    
    .typing-dot:nth-child(1) { animation-delay: 0ms; }
    .typing-dot:nth-child(2) { animation-delay: 200ms; }
    .typing-dot:nth-child(3) { animation-delay: 400ms; }
    
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-10px); }
    }
    
    .input-area {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.2);
      padding: 15px 20px;
      display: flex;
      gap: 10px;
      position: relative;
      z-index: 10;
    }
    
    textarea {
      flex: 1;
      border: 2px solid transparent;
      border-radius: 15px;
      padding: 12px 15px;
      resize: none;
      font-size: 14px;
      background: rgba(255, 255, 255, 0.9);
      transition: all 0.3s ease;
      font-family: inherit;
    }
    
    textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    button.send {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
      border: none;
      border-radius: 15px;
      padding: 12px 20px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    
    button.send:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }
    
    button.send:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .suggestions {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .suggestions button {
      background: rgba(102, 126, 234, 0.1);
      border: 1px solid rgba(102, 126, 234, 0.3);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #667eea;
    }
    
    .suggestions button:hover {
      background: rgba(102, 126, 234, 0.2);
      transform: translateY(-1px);
    }
    
    footer {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: #fff;
      font-size: 12px;
      text-align: center;
      padding: 8px;
      position: relative;
      z-index: 10;
    }
    
    .feature-pills {
      display: flex;
      gap: 10px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    
    .pill {
      background: rgba(102, 126, 234, 0.1);
      border: 1px solid rgba(102, 126, 234, 0.3);
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 11px;
      color: #667eea;
      font-weight: 500;
    }
    
    .chart-container {
      margin: 15px 0;
      padding: 15px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .mini-chart {
      width: 100%;
      height: 100px;
      background: linear-gradient(45deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #667eea;
      font-size: 12px;
    }
    
    .action-buttons {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    
    .action-btn {
      background: linear-gradient(45deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 11px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }
    
    @media (max-width: 768px) {
      .bubble {
        max-width: 85%;
      }
      
      header {
        padding: 10px 15px;
      }
      
      header h1 {
        font-size: 20px;
      }
      
      .input-area {
        padding: 10px 15px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>HelveticBot Pro</h1>
    <div class="status">
      <div class="status-dot"></div>
      <span>üá®üá≠ En ligne</span>
    </div>
  </header>

  <div class="chat" id="chat"></div>

  <div class="input-area">
    <textarea id="userInput" rows="1" placeholder="Posez votre question sur la finance, l'analyse ou la strat√©gie..."></textarea>
    <button class="send" id="sendBtn">‚û§</button>
  </div>

  <footer>
    ‚ö° Propuls√© par Helvetic AI ‚Ä¢ Donn√©es s√©curis√©es üá®üá≠ ‚Ä¢ v2.1 Pro
  </footer>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    let messageHistory = [];
    let isTyping = false;

    // Base de connaissances enrichie
    const knowledgeBase = {
      analyse: {
        keywords: ["analyse", "analyser", "analyse financi√®re", "√©tude", "diagnostic"],
        responses: [
          {
            text: "üìä <b>Analyse Financi√®re Avanc√©e</b><br><br>Je peux vous accompagner sur :<br>‚Ä¢ Analyse des ratios de liquidit√©<br>‚Ä¢ √âtude de rentabilit√© (ROE, ROA, ROIC)<br>‚Ä¢ Analyse du BFR et cash-flow<br>‚Ä¢ Benchmarking sectoriel<br>‚Ä¢ Diagnostic de performance",
            sugg: ["Calculer les ratios", "Analyser la solvabilit√©", "Comparer √† la concurrence", "Tendances sectorielles"]
          },
          {
            text: "üîç <b>Diagnostic Approfondi</b><br><br>Voici ma m√©thodologie :<br>‚Ä¢ Collecte et validation des donn√©es<br>‚Ä¢ Analyse verticale et horizontale<br>‚Ä¢ Identification des KPIs critiques<br>‚Ä¢ Recommandations strat√©giques",
            sugg: ["D√©finir les KPIs", "Cr√©er un tableau de bord", "Planifier les actions", "Automatiser le suivi"]
          }
        ]
      },
      budget: {
        keywords: ["budget", "pr√©vision", "pr√©visions", "planification", "projection"],
        responses: [
          {
            text: "üìà <b>Pr√©visions Budg√©taires Intelligentes</b><br><br>Technologies disponibles :<br>‚Ä¢ Machine Learning pr√©dictif<br>‚Ä¢ Mod√®les statistiques avanc√©s<br>‚Ä¢ Analyse de tendances macro<br>‚Ä¢ Sc√©narios Monte Carlo<br>‚Ä¢ Pr√©visions multi-horizons",
            sugg: ["Cr√©er un mod√®le", "D√©finir des sc√©narios", "Configurer les alertes", "Optimiser la pr√©cision"]
          }
        ]
      },
      automatisation: {
        keywords: ["automatisation", "automatiser", "robot", "processus", "workflow"],
        responses: [
          {
            text: "‚öôÔ∏è <b>Automatisation Intelligente</b><br><br>Processus automatisables :<br>‚Ä¢ Rapprochements bancaires<br>‚Ä¢ Facturation et recouvrement<br>‚Ä¢ Contr√¥les qualit√©<br>‚Ä¢ Reporting automatique<br>‚Ä¢ Alertes pr√©dictives",
            sugg: ["Cartographier les processus", "Estimer le ROI", "Planifier la mise en ≈ìuvre", "Former les √©quipes"]
          }
        ]
      },
      strategie: {
        keywords: ["strat√©gie", "strat√©gique", "plan", "d√©veloppement", "croissance"],
        responses: [
          {
            text: "üéØ <b>Strat√©gie Financi√®re</b><br><br>Accompagnement strat√©gique :<br>‚Ä¢ Mod√©lisation financi√®re<br>‚Ä¢ Plan de financement<br>‚Ä¢ Optimisation fiscale<br>‚Ä¢ Strat√©gie d'investissement<br>‚Ä¢ Gestion des risques",
            sugg: ["Mod√©liser la croissance", "Optimiser la structure", "√âvaluer les risques", "Planifier les investissements"]
          }
        ]
      },
      reporting: {
        keywords: ["rapport", "reporting", "dashboard", "tableau de bord", "kpi"],
        responses: [
          {
            text: "üìã <b>Reporting Dynamique</b><br><br>Solutions de reporting :<br>‚Ä¢ Dashboards interactifs<br>‚Ä¢ Rapports automatis√©s<br>‚Ä¢ KPIs en temps r√©el<br>‚Ä¢ Visualisations avanc√©es<br>‚Ä¢ Alertes personnalis√©es",
            sugg: ["Cr√©er un dashboard", "D√©finir les KPIs", "Automatiser les rapports", "Personnaliser les vues"]
          }
        ]
      }
    };

    function addMessage(content, type, suggestions = [], showChart = false) {
      const div = document.createElement('div');
      div.className = `message ${type}`;
      
      // Avatar
      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.textContent = type === 'bot' ? 'ü§ñ' : 'üë§';
      
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.innerHTML = content;
      
      if (type === 'bot') {
        div.appendChild(avatar);
        div.appendChild(bubble);
      } else {
        div.appendChild(bubble);
        div.appendChild(avatar);
      }

      // Ajout d'un mini graphique pour certaines r√©ponses
      if (showChart) {
        const chartContainer = document.createElement('div');
        chartContainer.className = 'chart-container';
        chartContainer.innerHTML = `
          <div class="mini-chart">
            üìä Graphique interactif disponible
          </div>
        `;
        bubble.appendChild(chartContainer);
      }

      // Suggestions am√©lior√©es
      if (type === 'bot' && suggestions.length) {
        const suggDiv = document.createElement('div');
        suggDiv.className = 'suggestions';
        suggestions.forEach(text => {
          const btn = document.createElement('button');
          btn.textContent = text;
          btn.onclick = () => {
            input.value = text;
            sendMessage();
          };
          suggDiv.appendChild(btn);
        });
        bubble.appendChild(suggDiv);
      }

      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
      
      // Sauvegarde de l'historique
      messageHistory.push({
        content: content.replace(/<[^>]*>/g, ''),
        type: type,
        timestamp: new Date()
      });
    }

    function showTyping() {
      const div = document.createElement('div');
      div.className = 'message bot typing-indicator';
      div.innerHTML = `
        <div class="avatar">ü§ñ</div>
        <div class="bubble">
          <div class="typing">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
        </div>
      `;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
      return div;
    }

    function removeTyping(element) {
      if (element && element.parentNode) {
        element.parentNode.removeChild(element);
      }
    }

    function findBestResponse(message) {
      const lower = message.toLowerCase();
      
      // Recherche dans la base de connaissances
      for (const category in knowledgeBase) {
        const categoryData = knowledgeBase[category];
        for (const keyword of categoryData.keywords) {
          if (lower.includes(keyword)) {
            const responses = categoryData.responses;
            return responses[Math.floor(Math.random() * responses.length)];
          }
        }
      }
      
      // R√©ponses contextuelles bas√©es sur l'historique
      if (messageHistory.length > 0) {
        const lastMessage = messageHistory[messageHistory.length - 1];
        if (lastMessage.type === 'bot' && lower.includes("comment")) {
          return {
            text: "üí° <b>Assistance Personnalis√©e</b><br><br>Je peux vous guider √©tape par √©tape :<br>‚Ä¢ D√©finir vos objectifs<br>‚Ä¢ Identifier les outils n√©cessaires<br>‚Ä¢ Planifier la mise en ≈ìuvre<br>‚Ä¢ Suivre les r√©sultats",
            sugg: ["Commencer l'analyse", "Voir des exemples", "Planifier ensemble", "Obtenir plus d'infos"]
          };
        }
      }
      
      // R√©ponses sp√©ciales pour des mots-cl√©s sp√©cifiques
      if (lower.includes("merci") || lower.includes("parfait")) {
        return {
          text: "üòä <b>Avec plaisir !</b><br><br>N'h√©sitez pas si vous avez d'autres questions. Je suis l√† pour optimiser vos processus financiers !",
          sugg: ["Nouvelle analyse", "Explorer d'autres fonctions", "Obtenir de l'aide"]
        };
      }
      
      if (lower.includes("prix") || lower.includes("co√ªt") || lower.includes("tarif")) {
        return {
          text: "üí∞ <b>Solutions Adapt√©es</b><br><br>Nos services s'adaptent √† votre budget :<br>‚Ä¢ Version gratuite : analyses de base<br>‚Ä¢ Pro : automatisation avanc√©e<br>‚Ä¢ Enterprise : solution compl√®te<br>‚Ä¢ Sur-mesure : d√©veloppement sp√©cifique",
          sugg: ["Comparer les versions", "Demander un devis", "Tester gratuitement", "Planifier une d√©mo"]
        };
      }
      
      // R√©ponse par d√©faut enrichie
      return {
        text: "ü§ñ <b>HelveticBot Pro √† votre service !</b><br><br>Expertise finance & technologie :<br>‚Ä¢ Analyses financi√®res avanc√©es<br>‚Ä¢ Pr√©visions intelligentes<br>‚Ä¢ Automatisation des processus<br>‚Ä¢ Strat√©gie & optimisation<br>‚Ä¢ Reporting dynamique",
        sugg: ["üîç Lancer une analyse", "üìä Cr√©er des pr√©visions", "‚öôÔ∏è Automatiser", "üéØ D√©finir la strat√©gie"],
        showChart: true
      };
    }

    function sendMessage() {
      const text = input.value.trim();
      if (!text || isTyping) return;
      
      // D√©sactiver le bouton d'envoi
      sendBtn.disabled = true;
      isTyping = true;
      
      addMessage(text, 'user');
      input.value = '';
      
      // Afficher l'indicateur de frappe
      const typingIndicator = showTyping();
      
      // Simuler le temps de r√©ponse
      setTimeout(() => {
        removeTyping(typingIndicator);
        const response = findBestResponse(text);
        addMessage(response.text, 'bot', response.sugg || [], response.showChart || false);
        
        // R√©activer le bouton
        sendBtn.disabled = false;
        isTyping = false;
      }, 1200 + Math.random() * 800);
    }

    // Gestionnaires d'√©v√©nements
    sendBtn.addEventListener('click', sendMessage);
    
    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
    
    // Auto-resize du textarea
    input.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 120) + 'px';
    });

    // Fonctions utilitaires
    function clearChat() {
      chat.innerHTML = '';
      messageHistory = [];
      showWelcomeMessage();
    }
    
    function exportChat() {
      const chatData = {
        messages: messageHistory,
        timestamp: new Date(),
        version: "HelveticBot Pro v2.1"
      };
      const blob = new Blob([JSON.stringify(chatData, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `helveticbot-chat-${new Date().toISOString().slice(0,10)}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function showWelcomeMessage() {
      const welcomeMsg = `üöÄ <b>Bienvenue dans HelveticBot Pro !</b><br><br>
      Votre assistant IA financier nouvelle g√©n√©ration üá®üá≠<br><br>
      
      <div class="feature-pills">
        <span class="pill">üîÆ IA Pr√©dictive</span>
        <span class="pill">‚ö° Temps R√©el</span>
        <span class="pill">üõ°Ô∏è S√©curis√©</span>
        <span class="pill">üá®üá≠ Swiss Made</span>
      </div>
      
      <b>Domaines d'expertise :</b><br>
      ‚Ä¢ üìä Analyses financi√®res pouss√©es<br>
      ‚Ä¢ üìà Pr√©visions & mod√©lisation<br>
      ‚Ä¢ ‚öôÔ∏è Automatisation intelligente<br>
      ‚Ä¢ üéØ Strat√©gie & optimisation<br>
      ‚Ä¢ üìã Reporting dynamique<br><br>
      
      <div class="action-buttons">
        <button class="action-btn" onclick="input.value='Faire une analyse compl√®te'; sendMessage();">üîç Analyse Express</button>
        <button class="action-btn" onclick="input.value='Cr√©er des pr√©visions'; sendMessage();">üìä Pr√©visions</button>
        <button class="action-btn" onclick="input.value='Automatiser mes processus'; sendMessage();">‚öôÔ∏è Automatisation</button>
      </div>`;
      
      addMessage(welcomeMsg, "bot", [
        "üöÄ D√©marrer une analyse",
        "üìä Cr√©er un dashboard", 
        "üí° Optimiser ma strat√©gie",
        "üîß Configurer l'automatisation"
      ]);
    }

    // Commandes sp√©ciales
    function handleSpecialCommands(text) {
      const lower = text.toLowerCase();
      
      if (lower === '/clear' || lower === '/reset') {
        clearChat();
        return true;
      }
      
      if (lower === '/export') {
        exportChat();
        addMessage("üíæ <b>Export r√©ussi !</b><br>Votre conversation a √©t√© export√©e.", "bot");
        return true;
      }
      
      if (lower === '/help' || lower === '/aide') {
        addMessage(`üÜò <b>Aide HelveticBot Pro</b><br><br>
        <b>Commandes sp√©ciales :</b><br>
        ‚Ä¢ /clear - Effacer la conversation<br>
        ‚Ä¢ /export - Exporter l'historique<br>
        ‚Ä¢ /help - Afficher cette aide<br><br>
        
        <b>Fonctionnalit√©s :</b><br>
        ‚Ä¢ Tapez naturellement vos questions<br>
        ‚Ä¢ Utilisez les suggestions pour explorer<br>
        ‚Ä¢ Mentionnez vos besoins sp√©cifiques<br>
        ‚Ä¢ Demandez des exemples concrets`, "bot", [
          "Voir des exemples",
          "Tester une analyse",
          "Explorer l'automatisation"
        ]);
        return true;
      }
      
      return false;
    }

    // Version am√©lior√©e de sendMessage
    function sendMessage() {
      const text = input.value.trim();
      if (!text || isTyping) return;
      
      // V√©rifier les commandes sp√©ciales
      if (handleSpecialCommands(text)) {
        input.value = '';
        return;
      }
      
      sendBtn.disabled = true;
      isTyping = true;
      
      addMessage(text, 'user');
      input.value = '';
      
      const typingIndicator = showTyping();
      
      // Temps de r√©ponse variable selon la complexit√©
      const complexity = text.length > 50 ? 2000 : 1200;
      const randomDelay = Math.random() * 600;
      
      setTimeout(() => {
        removeTyping(typingIndicator);
        const response = findBestResponse(text);
        addMessage(response.text, 'bot', response.sugg || [], response.showChart || false);
        
        sendBtn.disabled = false;
        isTyping = false;
      }, complexity + randomDelay);
    }

    // Auto-focus sur l'input
    input.focus();

    // Message d'accueil au chargement
    setTimeout(() => {
      showWelcomeMessage();
    }, 500);
  </script>
</body>
</html>
